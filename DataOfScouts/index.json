/********************* ROLES **********************/

CREATE ROLE RDB$ADMIN;
/********************* UDFS ***********************/

/****************** GENERATORS ********************/

CREATE GENERATOR GEN_LEAGUE_INFO;
CREATE GENERATOR GEN_PARTICIPANT_RESULTS;
CREATE GENERATOR GEN_PARTICIPANT_STATS;
CREATE GENERATOR GEN_PLAYERS;
/******************** DOMAINS *********************/

CREATE DOMAIN SEC$KEY
 AS Varchar(10) CHARACTER SET UNICODE_FSS
 NOT NULL
 COLLATE UNICODE_FSS;
CREATE DOMAIN SEC$NAME_PART
 AS Varchar(10) CHARACTER SET UNICODE_FSS
 NOT NULL
 COLLATE UNICODE_FSS;
CREATE DOMAIN SEC$USER_NAME
 AS Varchar(10) CHARACTER SET UNICODE_FSS
 NOT NULL
 COLLATE UNICODE_FSS;
CREATE DOMAIN SEC$VALUE
 AS Varchar(85) CHARACTER SET UNICODE_FSS
 NOT NULL
 COLLATE UNICODE_FSS;
CREATE DOMAIN TSTART_DATE
 AS Timestamp
 NOT NULL
;
/******************* PROCEDURES ******************/

SET TERM ^ ;
CREATE PROCEDURE ADD_ANALYSIS_HISTORY_INFO (
    IMATCH_CNT Integer,
    IREC Integer,
    CACT Varchar(1),
    EVENTID Integer,
    HOME_ID Integer,
    GUEST_ID Integer,
    START_DATE Timestamp,
    LEAGUEALIASID Integer,
    IMATCHMONTH Integer,
    IMATCHYEAR Integer,
    IMATCHSTATUS Integer,
    IHOSTSCORE Integer,
    IGUESTSCORE Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_ANALYSIS_RECENT_INFO (
    IMATCH_CNT Integer,
    IREC Integer,
    CACT Varchar(1),
    EVENTID Integer,
    START_DATE Timestamp,
    LEAGUEALIAS Varchar(8),
    CTEAMFLAG Varchar(1),
    CCHALLENGER Varchar(8),
    IMATCHSTATUS Integer,
    IHOSTSCORE Integer,
    IGUESTSCORE Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_ANALYSIS_STAT_INFO (
    IMATCH_CNT Integer,
    CACT Varchar(1),
    IHOSTWIN Integer,
    IHOSTDRAW Integer,
    IHOSTLOSS Integer,
    IGUESTWIN Integer,
    IGUESTDRAW Integer,
    IGUESTLOSS Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_AREA7 (
    ID Integer,
    AREA_CODE Varchar(5),
    NAME Varchar(100),
    PARENT_AREA_ID Integer,
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_COMPETITION (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    MINI_NAME Varchar(50),
    GENDER ,
    CTYPE Varchar(50),
    AREA_ID Integer,
    AREA_TYPE Varchar(50),
    AREA_SORT Integer,
    OVERALL_SORT Integer,
    TOUR_ID Integer,
    TOUR_NAME Varchar(50),
    UT Varchar(12),
    OLD_COMPETITION_ID Integer,
    SLUG Varchar(100),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_GROUP (
    ID Integer,
    NAME Varchar(30),
    UT Varchar(12),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_HKJCMATCH (
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    HKJCHOSTNAME_CN Varchar(100),
    HKJCGUESTNAME_CN Varchar(100),
    CLEAGUE_HKJC_NAME Varchar(30),
    LEAGUE_OUTPUT_NAME Varchar(30),
    LEAGUEALIAS_OUTPUT_NAME Varchar(10),
    CLEAGUE_SHT_ENG_NAME Varchar(5),
    CLEAGUE_ENG_NAME Varchar(99),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_HKJCMATCH2 (
    EMATCHID Integer,
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_HKJCMATCH4 (
    EMATCHID Integer,
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_HKJCMATCH_BAK (
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_PLAYER (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    BIRTHDATE Varchar(12),
    POSITION_NAME Varchar(20),
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    BENCH ,
    SHIRT_NR Integer,
    TEAM_ID Integer,
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_PLAYER2 (
    ID Integer,
    NAME Varchar(100),
    AREA_ID Integer,
    SLUG Varchar(100),
    BENCH ,
    SHIRT_NR Integer,
    TEAM_ID Integer,
    SEASON_ID Integer,
    EVENT_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_RANK_INFO (
    LEAG_ID Integer,
    CLEAG_ALIAS Varchar(8),
    SEASON_ID Integer,
    GROUP_ID Integer,
    TEAM_ID Integer,
    TEAM Varchar(50),
    HKJC_TEAM Varchar(10),
    SCORE Integer,
    RANK Integer,
    FLAG Varchar(1),
    GAMES Integer,
    IWON Integer,
    IDRAW Integer,
    ILOST Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_SCORERS_INFO (
    CLEAG_ID Integer,
    CLEAG_ALIAS Varchar(8),
    SEASON_ID Integer,
    TEAM_ID Integer,
    PLAYER_ID Integer,
    CPLAYER_NAME Varchar(50),
    CTEAM_ABBR Varchar(4),
    CACT Varchar(1),
    IRID Integer,
    IRANK Integer,
    IGOALS Integer,
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_SEASON (
    ID Integer,
    NAME Varchar(100),
    COMPETITION_ID Integer,
    SYEAR Varchar(10),
    ACTUAL Varchar(10),
    UT Varchar(12),
    OLD_SEASON_ID Integer,
    RANGE Varchar(10),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_STAGE (
    ID Integer,
    STAGE_NAME_ID Integer,
    NAME Varchar(50),
    START_DATE Varchar(12),
    END_DATE Varchar(12),
    SHOW_STANDINGS ,
    GROUPS_NR Integer,
    ISORT Integer,
    IS_CURRENT ,
    UT Varchar(12),
    OLD_STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_STANDINGS (
    ID Integer,
    COMPETITION_ID Integer,
    CCOMPNAME Varchar(99),
    OBJECT_ID Integer,
    OBJECT_NAME Varchar(50),
    OBJECT_TYPE Varchar(10),
    SUBTYPE Varchar(10),
    TYPE_NAME Varchar(30),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_TEAM (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE ADD_TEAM2 (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE DELETEEVENT_BYID (
    ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE DELETE_INCIDENTS_BYEVENTID (
    ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_EVENT_DETAILS (
    EVENTID Integer,
    WC_8 Varchar(20),
    PC_36 Varchar(20),
    PL_16 Varchar(3),
    EPL_50 Varchar(3),
    NOP_17 Varchar(1),
    EPTC_58 Varchar(100),
    IT_151 Varchar(2),
    ATT_141 Varchar(50),
    FHSD_19 Timestamp,
    SHSD_20 Timestamp,
    FEHSD_44 Timestamp,
    SEHSD_45 Timestamp,
    PSSD_150 Timestamp,
    FHIT_201 Varchar(2),
    SHIT_202 Varchar(2),
    FEHIT_203 Varchar(2),
    SEHIT_204 Varchar(2),
    HL_205 Varchar(8),
    TD_124 Varchar(4),
    BM_160 Varchar(4),
    HF_178 Varchar(4),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_EVENT_DETAILS_BAK (
    EVENTID Integer,
    WC_8 Varchar(20),
    PC_36 Varchar(20),
    PL_16 Varchar(3),
    EPL_50 Varchar(3),
    NOP_17 Varchar(1),
    EPTC_58 Varchar(100),
    IT_151 Varchar(2),
    ATT_141 Varchar(50),
    FHSD_19 Timestamp,
    SHSD_20 Timestamp,
    FEHSD_44 Timestamp,
    SEHSD_45 Timestamp,
    PSSD_150 Timestamp,
    FHIT_201 Varchar(2),
    SHIT_202 Varchar(2),
    FEHIT_203 Varchar(2),
    SEHIT_204 Varchar(2),
    HL_205 Varchar(8),
    TD_124 Varchar(4),
    BM_160 Varchar(4),
    HF_178 Varchar(4),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_INCIDENTS (
    ID Varchar(12),
    EVENTID Integer,
    CACTION Varchar(8),
    INCIDENT_ID Integer,
    INCIDENT_NAME Varchar(50),
    PARTICIPANT_ID Varchar(100),
    PARTICIPANT_NAME Varchar(100),
    SUBPARTICIPANT_ID Varchar(100),
    SUBPARTICIPANT_NAME Varchar(100),
    IMPORTANT_FOR_TRADER ,
    EVENT_TIME Varchar(6),
    EVENT_STATUS_ID Integer,
    EVENT_STATUS_NAME Varchar(50),
    UT Varchar(12),
    CTIMESTAMP Timestamp,
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_JSON_EVENT (
    ID Integer,
    NAME Varchar(100),
    HOME_ID Integer,
    GUEST_ID Integer,
    RELATION_STATUS Varchar(15),
    START_DATE Timestamp,
    FT_ONLY ,
    COVERAGE_TYPE Varchar(10),
    SCOUTSFEED ,
    STATUS_ID Integer,
    STATUS_TYPE Varchar(15),
    CDAY Varchar(10),
    CLOCK_TIME Varchar(18),
    CLOCK_STATUS Varchar(10),
    BET_STATUS Varchar(10),
    NEUTRAL_VENUE ,
    ITEM_STATUS Varchar(10),
    UT Varchar(12),
    ROUND_ID Varchar(10),
    ROUND_NAME Varchar(50),
    VENUE_ID Varchar(10),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp,
    CACTION Varchar(6) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_JSON_EVENT_BAK (
    ID Integer,
    NAME Varchar(100),
    HOME_ID Integer,
    GUEST_ID Integer,
    RELATION_STATUS Varchar(15),
    START_DATE Timestamp,
    FT_ONLY ,
    COVERAGE_TYPE Varchar(10),
    SCOUTSFEED ,
    STATUS_ID Integer,
    STATUS_TYPE Varchar(15),
    CDAY Varchar(10),
    CLOCK_TIME Varchar(18),
    CLOCK_STATUS Varchar(10),
    BET_STATUS Varchar(10),
    NEUTRAL_VENUE ,
    ITEM_STATUS Varchar(10),
    ROUND_ID Varchar(10),
    ROUND_NAME Varchar(50),
    VENUE_ID Varchar(10),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp,
    CACTION Varchar(6) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_PARTICIPANT_RESULTS (
    EVENTID Integer,
    PARTICIPANTID Integer,
    PROGRESS_412 Varchar(1),
    WINNER_411 Varchar(1),
    RESULT_2 Varchar(3),
    RT_3 Varchar(3),
    FH_4 Varchar(3),
    SH_5 Varchar(3),
    E1H_133 Varchar(2),
    E2H_134 Varchar(2),
    PENALTY_7 Varchar(2),
    OVERTIME_104 Varchar(2),
    CTIMESTAMP Timestamp,
    CACTION Varchar(6),
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_PARTICIPANT_STATS (
    EVENTID Integer,
    PARTICIPANTID Integer,
    SOT_20 Varchar(3),
    SOT_21 Varchar(3),
    ATTACKS_10 Varchar(3),
    DA_11 Varchar(3),
    CORNERS_13 Varchar(3),
    YELLOW_CARDS_8 Varchar(3),
    RED_CARDS_9 Varchar(3),
    TOTAL_SHOTS_19 Varchar(3),
    FOULS_22 Varchar(3),
    OFFSIDES_24 Varchar(3),
    PS_14 Varchar(3),
    PM_15 Varchar(3),
    PG_16 Varchar(3),
    FK_25 Varchar(10),
    DFK_26 Varchar(3),
    FKG_18 Varchar(3),
    SW_27 Varchar(3),
    SB_28 Varchar(3),
    GS_29 Varchar(3),
    GK_30 Varchar(3),
    TI_32 Varchar(3),
    SUBSTITUTIONS_31 Varchar(3),
    GOALS_40 Varchar(3),
    MP_34 Varchar(3),
    OWN_GOALS_17 Varchar(3),
    ADW_33 Varchar(3),
    FORM_716 Varchar(100),
    SKIN_718 Varchar(8),
    PS_639 Varchar(3),
    PU_697 Varchar(3),
    GOALS115_772 Varchar(3),
    GOALS1630_773 Varchar(3),
    GOALS3145_774 Varchar(3),
    GOALS4660_775 Varchar(3),
    GOALS6175_776 Varchar(3),
    GOALS7690_777 Varchar(3),
    MPG_778 Varchar(3),
    MPS_779 Varchar(3),
    CTIMESTAMP Timestamp,
    CACTION Varchar(6),
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_RESULT_GOALINFO (
    EMATCHID Integer,
    STATUS Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_STATS_GOALINFO (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_STATS_RESULT_GOALINFO (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    STATUSID Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE PR_STATS_RESULT_GOALINFO_BAK (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SET_BOOKEDEVENT (
    ID Integer,
    BOOKED ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SET_BOOKEDEVENTBY (
    ID Integer,
    BOOKED ,
    BOOKED_BY Varchar(50),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNCHKJCDATAANDBOOK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_AUTO (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_AUTO_BAK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_AUTO_BAK2 (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME (
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp,
    ALIAS Varchar(6) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME_BAK (
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCDATA_BOOK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_HKJCTEAM_WEB_SURE (
    EVENT_ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCDATA (
    EVENT_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCDATA_WEB (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_CANCEL (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE UPDATE_CNNAME_GOALINFO_PLAYERS (
    EMATCHID Varchar(20),
    TEAMID Integer,
    PARTICIPANTID Varchar(12),
    ENNAME Varchar(60),
    CNNAME Varchar(60),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE WEB_SYNC_MANUAL_HKJCDATA (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

SET TERM ^ ;
CREATE PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_SURE (
    EVENT_ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN SUSPEND; END^
SET TERM ; ^

/******************** TABLES **********************/

CREATE TABLE ANALYSIS_BG_INFO
(
  IMATCH_CNT Integer NOT NULL,
  CMATCH_VENUE Varchar(50),
  CTEMPERATURE Varchar(10),
  IWEATHER_STATUS Integer,
  CACT Varchar(1),
  IFLAG_HISTORY Integer,
  IFLAG_PLAYERS Integer,
  IFLAG_REMARK Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (IMATCH_CNT)
);
CREATE TABLE ANALYSIS_HISTORY_INFO
(
  IMATCH_CNT Integer NOT NULL,
  IREC Integer NOT NULL,
  CACT Varchar(1),
  EVENTID Integer,
  HOME_ID Integer,
  GUEST_ID Integer,
  START_DATE Timestamp,
  LEAGUEALIASID Integer,
  LEAGUEALIAS Varchar(8),
  IMATCHMONTH Integer,
  IMATCHYEAR Integer,
  IMATCHSTATUS Integer,
  IHOSTSCORE Integer,
  IGUESTSCORE Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (IMATCH_CNT,IREC)
);
CREATE TABLE ANALYSIS_OTHERS
(
  EVENTID Integer NOT NULL,
  CLEAGUE Varchar(12),
  CTEAM Varchar(50) NOT NULL,
  CTEAMTYPE Varchar(8) NOT NULL,
  CACTION Varchar(1),
  CSHOTS Varchar(30),
  CFOULS Varchar(30),
  CCORNER_KICKS Varchar(30),
  COFFSIDES Varchar(30),
  CPOSSESSION Varchar(30),
  CYELLOW_CARDS Varchar(30),
  CRED_CARDS Varchar(30),
  CATTACKS Varchar(30),
  CSUBSTITUTIONS Varchar(30),
  CTHROWINS Varchar(30),
  CGOALKICKS Varchar(30),
  CTIMESTAMP Varchar(24),
  PRIMARY KEY (EVENTID,CTEAM,CTEAMTYPE)
);
CREATE TABLE ANALYSIS_RECENT_INFO
(
  IMATCH_CNT Integer NOT NULL,
  IREC Integer NOT NULL,
  CACT Varchar(1),
  EVENTID Integer,
  START_DATE Timestamp,
  LEAGUEALIASID Integer,
  LEAGUEALIAS Varchar(8),
  CTEAMFLAG Varchar(1),
  CCHALLENGER Varchar(50),
  IMATCHSTATUS Integer,
  IHOSTSCORE Integer,
  IGUESTSCORE Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (IMATCH_CNT,IREC)
);
CREATE TABLE ANALYSIS_REMARK_INFO
(
  IMATCH_CNT Integer NOT NULL,
  CACT Varchar(1),
  CREMARKS Varchar(300),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (IMATCH_CNT)
);
CREATE TABLE ANALYSIS_STAT_INFO
(
  IMATCH_CNT Integer NOT NULL,
  CACT Varchar(1),
  IHOSTWIN Integer,
  IHOSTDRAW Integer,
  IHOSTLOSS Integer,
  IGUESTWIN Integer,
  IGUESTDRAW Integer,
  IGUESTLOSS Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (IMATCH_CNT)
);
CREATE TABLE AREAS
(
  ID Integer NOT NULL,
  AREA_CODE Varchar(5),
  NAME Varchar(100),
  PARENT_AREA_ID Integer,
  UT Varchar(12),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (ID)
);
CREATE TABLE AREAS2
(
  ID Integer NOT NULL,
  AREA_CODE Varchar(5),
  NAME Varchar(100),
  PARENT_AREA_ID Integer,
  UT Varchar(12),
  CTIMESTAMP Varchar(25),
  PRIMARY KEY (ID)
);
CREATE TABLE COMPETITIONS
(
  ID Integer NOT NULL,
  NAME Varchar(100),
  SHORT_NAME Varchar(50),
  MINI_NAME Varchar(50),
  GENDER ,
  CTYPE Varchar(50),
  AREA_ID Integer,
  AREA_NAME Varchar(50),
  AREA_TYPE Varchar(50),
  AREA_SORT Integer,
  AREA_CODE Varchar(5),
  OVERALL_SORT Integer,
  TOUR_ID Integer,
  TOUR_NAME Varchar(50),
  UT Varchar(12),
  OLD_COMPETITION_ID Integer,
  SLUG Varchar(100),
  CTIMESTAMP Timestamp,
  ALIAS Varchar(6),
  PRIMARY KEY (ID)
);
CREATE TABLE EMATCHES
(
  EMATCHID Integer,
  HKJCHOSTID Integer,
  HKJCGUESTID Integer,
  HKJCHOSTNAME Varchar(100),
  HKJCGUESTNAME Varchar(100),
  HKJCDAYCODE Varchar(3),
  HKJCMATCHNO Integer,
  STATUS Varchar(30),
  CMATCHDATETIME Timestamp,
  MAPPINGSTATUS ,
  CTIMESTAMP Timestamp,
  HKJCHOSTNAME_CN Varchar(100),
  HKJCGUESTNAME_CN Varchar(100),
  CLEAGUE_HKJC_NAME Varchar(30),
  CLEAGUE_OUTPUT_NAME Varchar(30),
  CLEAGUEALIAS_OUTPUT_NAME Varchar(10),
  CLEAGUE_SHT_ENG_NAME Varchar(5),
  CLEAGUE_ENG_NAME Varchar(99)
);
CREATE TABLE EVENTS
(
  ID Integer NOT NULL,
  NAME Varchar(100),
  HOME_ID Integer NOT NULL,
  GUEST_ID Integer NOT NULL,
  SOURCE Varchar(10),
  SOURCE_DC ,
  SOURCE_SUPER Varchar(10),
  RELATION_STATUS Varchar(15),
  START_DATE TSTART_DATE,
  FT_ONLY ,
  COVERAGE_TYPE Varchar(10),
  CHANNEL_ID Varchar(10),
  CHANNEL_NAME Varchar(50),
  SCOUTSFEED ,
  STATUS_ID Integer,
  STATUS_NAME Varchar(30),
  STATUS_TYPE Varchar(15),
  CDAY Varchar(10),
  CLOCK_TIME Varchar(18),
  CLOCK_STATUS Varchar(10),
  WINNER_ID Varchar(10),
  PROGRESS_ID Varchar(10),
  BET_STATUS Varchar(10),
  NEUTRAL_VENUE ,
  ITEM_STATUS Varchar(10),
  UT Varchar(12),
  OLD_EVENT_ID Integer,
  SLUG Varchar(100),
  VERIFIED_RESULT ,
  IS_PROTOCOL_VERIFIED ,
  PROTOCOL_VERIFIED_BY Varchar(10),
  PROTOCOL_VERIFIED_AT Varchar(10),
  ROUND_ID Varchar(10),
  ROUND_NAME Varchar(50),
  CLIENT_EVENT_ID Integer,
  BOOKED ,
  BOOKED_BY Varchar(50),
  INVERTED_PARTICIPANTS ,
  VENUE_ID Varchar(10),
  GROUP_ID Integer,
  STAGE_ID Integer,
  SEASON_ID Integer,
  COMPETITION_ID Integer,
  AREA_ID Integer,
  CTIMESTAMP Timestamp,
  CACTION Varchar(6),
  PRIMARY KEY (ID)
);
CREATE TABLE EVENT_DETAILS
(
  EVENTID Integer NOT NULL,
  WC_8 Varchar(20),
  PC_36 Varchar(20),
  PL_16 Varchar(3),
  EPL_50 Varchar(3),
  NOP_17 Varchar(1),
  EPTC_58 Varchar(100),
  IT_151 Varchar(2),
  ATT_141 Varchar(50),
  FHSD_19 Timestamp,
  SHSD_20 Timestamp,
  FEHSD_44 Timestamp,
  SEHSD_45 Timestamp,
  PSSD_150 Timestamp,
  FHIT_201 Varchar(2),
  SHIT_202 Varchar(2),
  FEHIT_203 Varchar(2),
  SEHIT_204 Varchar(2),
  HL_205 Varchar(8),
  TD_124 Varchar(4),
  BM_160 Varchar(4),
  HF_178 Varchar(4),
  UT Varchar(12),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (EVENTID)
);
CREATE TABLE GOALINFO
(
  EMATCHID Integer NOT NULL,
  HRUNSCOREID Integer,
  GRUNSCOREID Integer,
  H_GOAL Integer,
  G_GOAL Integer,
  H_YELLOW Integer,
  H_RED Integer,
  G_YELLOW Integer,
  G_RED Integer,
  RECTIME Timestamp,
  LASTTIME Timestamp,
  GAMESTATUS Varchar(30),
  STATUSFK Integer,
  ELAPSED Integer,
  TEAMTYPE Varchar(1),
  HH_GOAL Integer,
  GH_GOAL Integer,
  H_CONFIRM Integer,
  G_CONFIRM Integer,
  PRIMARY KEY (EMATCHID)
);
CREATE TABLE GOALINFO_LOG
(
  EMATCHID Integer NOT NULL,
  LASTTIME Timestamp,
  GAMESTATUS Varchar(100),
  ELAPSED Integer,
  LOG_TYPE Varchar(100),
  AID Varchar(2000)
);
CREATE TABLE GROUPS
(
  ID Integer NOT NULL,
  NAME Varchar(30),
  UT Varchar(12),
  STAGE_ID Integer NOT NULL,
  SEASON_ID Integer NOT NULL,
  COMPETITION_ID Integer NOT NULL,
  AREA_ID Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (ID,STAGE_ID,SEASON_ID,COMPETITION_ID)
);
CREATE TABLE INCIDENTS
(
  ID Varchar(12),
  EVENTID Integer,
  CACTION Varchar(8),
  INCIDENT_ID Integer,
  INCIDENT_NAME Varchar(50),
  PARTICIPANT_ID Varchar(100),
  PARTICIPANT_NAME Varchar(100),
  SUBPARTICIPANT_ID Varchar(100),
  SUBPARTICIPANT_NAME Varchar(100),
  IMPORTANT_FOR_TRADER ,
  EVENT_TIME Varchar(6),
  EVENT_STATUS_ID Integer,
  EVENT_STATUS_NAME Varchar(50),
  UT Varchar(12),
  CTIMESTAMP Timestamp,
  TEAMTYPE Varchar(1)
);
CREATE TABLE INT_COUNTRY
(
  COUNTRY_CHI_NAME Varchar(10) NOT NULL,
  COUNTRY_ENG_NAME Varchar(30) NOT NULL
);
CREATE TABLE INT_LEAGUE
(
  LEAGUE_CHI_NAME Varchar(20) NOT NULL,
  LEAGUE_ENG_NAME Varchar(30) NOT NULL,
  COUNTRY_CHI_NAME Varchar(20) NOT NULL
);
CREATE TABLE INT_PLAYER
(
  PLAYER_CHI_NAME Varchar(20) NOT NULL,
  PLAYER_ENG_NAME Varchar(60) NOT NULL,
  SHIRT_NO Integer,
  "POSITION" Varchar(10),
  TEAM_CHI_NAME Varchar(20) NOT NULL,
  COUNTRY_CHI_NAME Varchar(20) NOT NULL
);
CREATE TABLE INT_TEAM
(
  TEAM_CHI_NAME Varchar(20) NOT NULL,
  TEAM_ENG_NAME Varchar(30) NOT NULL,
  LEAGUE_CHI_NAME Varchar(20) NOT NULL
);
CREATE TABLE LEAGRANKINFO
(
  LEAG_ID Integer NOT NULL,
  CLEAG_ALIAS Varchar(8),
  SEASON_ID Integer NOT NULL,
  GROUP_ID Integer,
  TEAM_ID Integer NOT NULL,
  TEAM Varchar(50),
  HKJC_TEAM Varchar(10),
  SCORE Integer,
  RANK Integer,
  FLAG Varchar(1),
  GAMES Integer,
  IWON Integer,
  IDRAW Integer,
  ILOST Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (LEAG_ID,SEASON_ID,TEAM_ID)
);
CREATE TABLE LEAGUE_INFO
(
  ILEAG_ID Integer NOT NULL,
  CLEAGUE_ALIAS_NAME Varchar(8),
  CLEAGUE_NAME Varchar(10),
  LEAGUE_CHI_NAME Varchar(30) NOT NULL,
  LEAGUE_ENG_NAME Varchar(99) NOT NULL,
  CLEAGUE_SHT_ENG_NAME Varchar(5),
  COUNTRY_CHI_NAME Varchar(20),
  CTIMESTAMP Timestamp
);
CREATE TABLE MATCHDETAILS
(
  ID Integer,
  EMATCHID Varchar(20),
  CTYPE Varchar(20),
  STATUS Varchar(30),
  LASTTIME Timestamp,
  PLAYER Varchar(60),
  PARTICIPANTID Varchar(12),
  ELAPSED Integer,
  UPDATETIME Timestamp,
  N Integer,
  INCIDENTTYPEFK Integer,
  HG Varchar(2),
  PLAYERCHI Varchar(60),
  INCIDENTS_ID Varchar(12),
  TEAM_ID Integer
);
CREATE TABLE PARTICIPANT_RESULTS
(
  ID Integer NOT NULL,
  EVENTID Integer NOT NULL,
  PARTICIPANTID Integer NOT NULL,
  PROGRESS_412 Varchar(1),
  WINNER_411 Varchar(1),
  RESULT_2 Varchar(3),
  RT_3 Varchar(3),
  FH_4 Varchar(3),
  SH_5 Varchar(3),
  E1H_133 Varchar(2),
  E2H_134 Varchar(2),
  PENALTY_7 Varchar(2),
  OVERTIME_104 Varchar(2),
  CTIMESTAMP Timestamp,
  CACTION Varchar(6),
  TEAMTYPE Varchar(1),
  PRIMARY KEY (EVENTID,PARTICIPANTID)
);
CREATE TABLE PARTICIPANT_STATS
(
  ID Integer NOT NULL,
  EVENTID Integer NOT NULL,
  PARTICIPANTID Integer NOT NULL,
  SOT_20 Varchar(3),
  SOT_21 Varchar(3),
  ATTACKS_10 Varchar(3),
  DA_11 Varchar(3),
  CORNERS_13 Varchar(3),
  YELLOW_CARDS_8 Varchar(3),
  RED_CARDS_9 Varchar(3),
  TOTAL_SHOTS_19 Varchar(3),
  FOULS_22 Varchar(3),
  OFFSIDES_24 Varchar(3),
  PS_14 Varchar(3),
  PM_15 Varchar(3),
  PG_16 Varchar(3),
  FK_25 Varchar(10),
  DFK_26 Varchar(3),
  FKG_18 Varchar(3),
  SW_27 Varchar(3),
  SB_28 Varchar(3),
  GS_29 Varchar(3),
  GK_30 Varchar(3),
  TI_32 Varchar(3),
  SUBSTITUTIONS_31 Varchar(3),
  GOALS_40 Varchar(3),
  MP_34 Varchar(3),
  OWN_GOALS_17 Varchar(3),
  ADW_33 Varchar(3),
  FORM_716 Varchar(100),
  SKIN_718 Varchar(8),
  PS_639 Varchar(3),
  PU_697 Varchar(3),
  GOALS115_772 Varchar(3),
  GOALS1630_773 Varchar(3),
  GOALS3145_774 Varchar(3),
  GOALS4660_775 Varchar(3),
  GOALS6175_776 Varchar(3),
  GOALS7690_777 Varchar(3),
  MPG_778 Varchar(3),
  MPS_779 Varchar(3),
  CTIMESTAMP Timestamp,
  CACTION Varchar(6),
  TEAMTYPE Varchar(1),
  PRIMARY KEY (EVENTID,PARTICIPANTID)
);
CREATE TABLE PLAYERS
(
  IREC Integer NOT NULL,
  ID Integer NOT NULL,
  NAME Varchar(100),
  SHORT_NAME Varchar(50),
  ACRONYM Varchar(3),
  GENDER ,
  BIRTHDATE Varchar(12),
  POSITION_NAME Varchar(20),
  AREA_ID Integer,
  BNATIONAL ,
  UT Varchar(50),
  OLD_PARTICIPANT_ID Integer,
  SLUG Varchar(100),
  TEAM_ID Integer NOT NULL,
  BENCH ,
  SHIRT_NR Integer,
  SEASON_ID Integer,
  EVENT_ID Integer,
  NAME_CN Varchar(100),
  CTIMESTAMP Timestamp
);
CREATE TABLE PLAYERS_INFO
(
  EVENT_ID Integer NOT NULL,
  TEAM_ID Integer NOT NULL,
  PLAYER_ID Integer NOT NULL,
  IPLAYER_NO Integer,
  IPOS Integer DEFAULT 0,
  CPLAYER_NAME Varchar(50) NOT NULL,
  CCOUNTRY Varchar(50),
  IROSTER Integer,
  CENGNAME Varchar(50) NOT NULL,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (EVENT_ID,TEAM_ID,PLAYER_ID,CENGNAME)
);
CREATE TABLE SCORERS_INFO
(
  CLEAG_ID Integer,
  CLEAG_ALIAS Varchar(8) NOT NULL,
  SEASON_ID Integer NOT NULL,
  TEAM_ID Integer NOT NULL,
  PLAYER_ID Integer,
  CPLAYER_NAME Varchar(50) NOT NULL,
  CTEAM_ABBR Varchar(4),
  CACT Varchar(1) DEFAULT 'U',
  IRID Integer,
  IRANK Integer,
  IGOALS Integer,
  UT Varchar(12),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (CLEAG_ALIAS,SEASON_ID,TEAM_ID,CPLAYER_NAME)
);
CREATE TABLE SEASONS
(
  ID Integer NOT NULL,
  NAME Varchar(100),
  COMPETITION_ID Integer,
  SYEAR Varchar(10),
  ACTUAL Varchar(10),
  UT Varchar(12),
  OLD_SEASON_ID Integer,
  RANGE Varchar(10),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (ID)
);
CREATE TABLE STAGES
(
  ID Integer NOT NULL,
  STAGE_NAME_ID Integer,
  NAME Varchar(50),
  START_DATE Varchar(12),
  END_DATE Varchar(12),
  SHOW_STANDINGS ,
  GROUPS_NR Integer,
  ISORT Integer,
  IS_CURRENT ,
  UT Varchar(12),
  OLD_STAGE_ID Integer,
  SEASON_ID Integer,
  COMPETITION_ID Integer,
  AREA_ID Integer,
  CTIMESTAMP Timestamp,
  PRIMARY KEY (ID)
);
CREATE TABLE STANDINGS_INFO
(
  ID Integer NOT NULL,
  COMPETITION_ID Integer NOT NULL,
  CCOMPNAME Varchar(99),
  SEASON_ID Integer,
  OBJECT_ID Integer,
  OBJECT_NAME Varchar(50),
  OBJECT_TYPE Varchar(10),
  SUBTYPE Varchar(10),
  TYPE_NAME Varchar(30),
  UT Varchar(12),
  CTIMESTAMP Timestamp,
  PRIMARY KEY (ID,COMPETITION_ID)
);
CREATE TABLE STATUSES
(
  ID Integer NOT NULL,
  NAME Varchar(30),
  SHORT_NAME Varchar(15),
  STATUS_TYPE Varchar(15),
  PRIMARY KEY (ID)
);
CREATE TABLE TEAMS
(
  ID Integer NOT NULL,
  NAME Varchar(100),
  SHORT_NAME Varchar(50),
  ACRONYM Varchar(3),
  GENDER ,
  AREA_ID Integer,
  BNATIONAL ,
  UT Varchar(50),
  OLD_PARTICIPANT_ID Integer,
  SLUG Varchar(100),
  SEASON_ID Integer,
  CTIMESTAMP Timestamp,
  HKJC_ID Integer,
  HKJC_NAME Varchar(100),
  HKJC_NAME_CN Varchar(100),
  MAPPING_STATUS 
);
/********************* VIEWS **********************/

/******************* EXCEPTIONS *******************/

/******************** TRIGGERS ********************/

SET TERM ^ ;
CREATE TRIGGER TR_EMATCHES_LEAGUE_INFO FOR EMATCHES ACTIVE
AFTER INSERT POSITION 0
AS     
DECLARE VARIABLE sLeague varchar(99); 
DECLARE VARIABLE sCOUNTRY varchar(20); 
BEGIN  
SELECT A.LEAGUE_ENG_NAME FROM LEAGUE_INFO a  WHERE a.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND A.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME into : sLeague;  
IF ( :sLeague is  null  OR  :sLeague ='' ) THEN  
begin 
Select i.COUNTRY_CHI_NAME  from INT_LEAGUE i where i.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND i.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME into : sCOUNTRY;  
 --IF ( :sCOUNTRY is not null  and  :sCOUNTRY !='' ) THEN  
   -- begin 
    --update LEAGUE_INFO l set l.COUNTRY_CHI_NAME=:sCOUNTRY,l.CTIMESTAMP=current_timestamp where   l.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND l.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME ;
    --end
insert into LEAGUE_INFO  (CLEAGUE_ALIAS_NAME,CLEAGUE_NAME,LEAGUE_CHI_NAME,LEAGUE_ENG_NAME,CLEAGUE_SHT_ENG_NAME,COUNTRY_CHI_NAME,CTIMESTAMP)
 VALUES (new.CLEAGUEALIAS_OUTPUT_NAME, NEW.CLEAGUE_OUTPUT_NAME,NEW.CLEAGUE_HKJC_NAME,NEW.CLEAGUE_ENG_NAME,NEW.CLEAGUE_SHT_ENG_NAME,:sCOUNTRY, current_timestamp);
  end
ELSE
  begin
  Select i.COUNTRY_CHI_NAME  from INT_LEAGUE i where i.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND i.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME into : sCOUNTRY; 
  UPDATE LEAGUE_INFO I  SET i.COUNTRY_CHI_NAME=:sCOUNTRY, I.CLEAGUE_ALIAS_NAME=NEW.CLEAGUEALIAS_OUTPUT_NAME,I.CLEAGUE_NAME=NEW.CLEAGUE_OUTPUT_NAME,I.CLEAGUE_SHT_ENG_NAME=NEW.CLEAGUE_SHT_ENG_NAME,I.CTIMESTAMP=current_timestamp
    WHERE I.LEAGUE_CHI_NAME= NEW.CLEAGUE_HKJC_NAME AND I.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME;
--Select i.COUNTRY_CHI_NAME  from INT_LEAGUE i where i.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND i.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME into : sCOUNTRY;  
 --IF ( :sCOUNTRY is not null  and  :sCOUNTRY !='' ) THEN  
    --begin 
    --update LEAGUE_INFO l set l.COUNTRY_CHI_NAME=:sCOUNTRY,l.CTIMESTAMP=current_timestamp where   l.LEAGUE_CHI_NAME=new.CLEAGUE_HKJC_NAME AND l.LEAGUE_ENG_NAME=NEW.CLEAGUE_ENG_NAME ;
    --end
  END 
 END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_EVENTS_EMATCHES FOR EVENTS ACTIVE
AFTER INSERT OR UPDATE POSITION 0
AS   
DECLARE VARIABLE MatchStatus varchar(30); 
BEGIN 
IF ( new.CACTION !='delete' ) THEN  
begin
--cancelled  deleted finished inprogress interrupted notstarted unknown
--Cancelled    /      Finished    /      Interrupted   Not started /  
 
IF(new.STATUS_NAME='Not started'  ) then
BEGIN
 MatchStatus='notstarted';
END  
else IF(new.STATUS_TYPE='live') then
BEGIN 
MatchStatus='inprogress';
-- Update goalinfo GAMESTATUS   
update goalinfo g set g.GAMESTATUS='gamestarted'  WHERE G.EMATCHID=NEW.ID AND G.GAMESTATUS='Not started';
END
else IF(new.RELATION_STATUS='in_progress') then
BEGIN 
MatchStatus='inprogress';
update goalinfo g set g.GAMESTATUS='gamestarted'  WHERE G.EMATCHID=NEW.ID AND G.GAMESTATUS='Not started';
END
else IF(new.STATUS_TYPE='finished') then
BEGIN 
MatchStatus='finished';
END
else IF(new.STATUS_NAME='Cancelled') then
BEGIN 
MatchStatus='cancelled';
END
else IF(new.STATUS_NAME='Interrupted') then
BEGIN
 MatchStatus='interrupted';
END 
--else IF(new.STATUS_NAME='Not started'  ) then
--BEGIN
 --MatchStatus='notstarted';
--END 
else IF(new.STATUS_NAME is null ) then
BEGIN
 MatchStatus='notstarted';
END 
else 
BEGIN
 MatchStatus=new.STATUS_NAME;
END  
--update  EMATCHES.STATUS
--UPDATE  EMATCHES e  set e.STATUS =new.RELATION_STATUS where e.EMATCHID=new.ID ;
UPDATE  EMATCHES e  set e.STATUS =:MatchStatus,e.CTIMESTAMP=new.CTIMESTAMP where e.EMATCHID=new.ID ;
 --log
 ----INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,log_type )VALUES  (new.ID,new.CTIMESTAMP,:MatchStatus,0 ,'EMatches') ;

end
 END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_EVENTS_GOALINFO FOR EVENTS ACTIVE
AFTER INSERT OR UPDATE POSITION 1
AS   
DECLARE VARIABLE sGameStatus varchar(30); 
--DECLARE VARIABLE iH_GOAL  integer;
--DECLARE VARIABLE iG_GOAL integer;
BEGIN 
IF ( new.CACTION !='delete' ) THEN  
begin
--"gamestarted" "firsthalfended" "secondhalfstarted"  "secondhalfended" "extratimestarted" "extratimefirsthalfended" 
--"extratimesecondhalfstarted"  "extratimesecondhalfended" "gameended"
--9 Halftime HT live 
--15 Extratime Extra  
--33 1st half 1st half  
--34 2nd half 2nd half  
--35 Extratime 1st half Extra 1st  
--36 Extratime 2nd half Extra 2nd  
--37 Extratime halftime Extra HT  
--48 Waiting for extratime Waiting ET  
--141 Penalty shootout Penalty  
--142 Waiting for penalty 

--IF(new.STATUS_NAME='Not started') then
IF(new.STATUS_ID=1) then
BEGIN 
sGameStatus=new.STATUS_NAME;
END
--IF(new.STATUS_NAME='Halftime') then
ELSE IF(new.STATUS_ID=9) then
BEGIN 
sGameStatus='firsthalfended';
END
--IF(new.STATUS_NAME='Finished') then
ELSE IF(new.STATUS_ID=11) then
BEGIN 
sGameStatus='secondhalfended';
END
--else IF(new.STATUS_NAME='Extratime') then
else IF(new.STATUS_ID=15) then
BEGIN 
sGameStatus='secondhalfended';
END
--else IF(new.STATUS_NAME='1st half') then
else IF(new.STATUS_ID=33) then
BEGIN
 sGameStatus='gamestarted';
END 
--else IF(new.STATUS_NAME='2nd half') then
else IF(new.STATUS_ID=34) then
BEGIN
 sGameStatus='secondhalfstarted';
END 
--else IF(new.STATUS_NAME='Extratime 1st half'  ) then
else IF(new.STATUS_ID=35) then
BEGIN
 sGameStatus='extratimestarted';
END 
--else IF(new.STATUS_NAME='Extratime 2nd half'  ) then
else IF(new.STATUS_ID=36) then
BEGIN
 sGameStatus='extratimesecondhalfstarted';
END 
--else IF(new.STATUS_NAME='Extratime halftime'  ) then
else IF(new.STATUS_ID=37) then
BEGIN
 sGameStatus='extratimefirsthalfended';
END  
--else IF(new.STATUS_NAME='Waiting for extratime'  ) then
else IF(new.STATUS_ID=48) then
BEGIN
 sGameStatus='secondhalfended';
END 
--else IF(new.STATUS_NAME='Penalty shootout'  ) then
else IF(new.STATUS_ID=141) then
BEGIN
 sGameStatus='gameended';
END  
--else IF(new.STATUS_NAME='Waiting for penalty'  ) then
else IF(new.STATUS_ID=142) then
BEGIN
 sGameStatus='gameended';
END 
else
BEGIN
 sGameStatus=new.STATUS_NAME;
END  

  if((NEW.STATUS_ID=9  and OLD.STATUS_ID=33)) then 
    begin
     --select first 1 g.H_GOAL,g.G_GOAL  from  GOALINFO g WHERE g.EMATCHID=NEW.ID ORDER BY  G.LASTTIME desc INTO :iH_GOAL,:iG_GOAL; 
     update GoalInfo set HH_GOAL=H_GOAL,GH_GOAL=G_GOAL where  EMATCHID=NEW.ID ;
     end 
 --update  GOALINFO.GAMESTATUS
 UPDATE OR INSERT INTO  GoalInfo (EMATCHID,GAMESTATUS,LASTTIME) VALUES (new.ID, :sGameStatus,new.CTIMESTAMP) MATCHING  (EMATCHID) ;
 --UPDATE OR INSERT INTO  GoalInfo (EMATCHID,  GAMESTATUS) VALUES (new.ID, :sGameStatus) MATCHING  (EMATCHID) ;

 --log
 ---INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,log_type )VALUES  (new.ID,new.CTIMESTAMP,:sGameStatus,0 ,'EGoalInfo') ;
end
 END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_GEN_LEAGUE_INFO FOR LEAGUE_INFO ACTIVE
BEFORE INSERT POSITION 0
AS 
BEGIN 
    if( (new.ILEAG_ID is null) or (new.ILEAG_ID=0)) then
    begin
        new.ILEAG_ID=gen_id(GEN_LEAGUE_INFO,1);
    end
END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_GEN_PARTICIPANT_RESULTS FOR PARTICIPANT_RESULTS ACTIVE
BEFORE INSERT POSITION 0
AS 
BEGIN 
    if( (new.ID is null) or (new.ID=0)) then
    begin
        new.ID=gen_id(GEN_participant_results,1);
    end
END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_GEN_PARTICIPANT_STATS FOR PARTICIPANT_STATS ACTIVE
BEFORE INSERT POSITION 0
AS 
BEGIN 
    if( (new.ID is null) or (new.ID=0)) then
    begin
        new.ID=gen_id(GEN_participant_stats,1);
    end
END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_GEN_PLAYERS FOR PLAYERS ACTIVE
BEFORE INSERT POSITION 0
AS 
BEGIN 
    if( (new.IREC is null) or (new.IREC=0)) then
    begin
        new.IREC=gen_id(GEN_PLAYERS,1);
    end
END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_INCIDENTS_MATCHDETAILS FOR INCIDENTS ACTIVE
AFTER INSERT OR UPDATE POSITION 0
AS  
DECLARE VARIABLE STYPE VARCHAR(20); 
DECLARE VARIABLE EVENTTIME integer; 
DECLARE VARIABLE playername varchar(100); 
DECLARE VARIABLE eplayername varchar(100); 
DECLARE VARIABLE sGameStatus varchar(30); 
DECLARE VARIABLE STATUSID integer; 
BEGIN 
--IF (new.CACTION !='delete' and new.SUBPARTICIPANT_NAME!='') THEN-- and (new.INCIDENT_ID=413 OR new.INCIDENT_ID=418 OR new.INCIDENT_ID=419 )) THEN 
IF (new.CACTION !='delete') THEN
BEGIN    
if (new.INCIDENT_ID=413 OR new.INCIDENT_ID=418 OR new.INCIDENT_ID=419 or 
new.INCIDENT_ID=405 OR new.INCIDENT_ID=410 OR new.INCIDENT_ID=408 or 
new.INCIDENT_ID=416 OR new.INCIDENT_ID=400 or 
new.INCIDENT_ID=450 OR new.INCIDENT_ID=452 OR new.INCIDENT_ID=421 OR new.INCIDENT_ID=422 OR new.INCIDENT_ID=424 OR new.INCIDENT_ID=423) THEN 
begin
IF(new.INCIDENT_ID=413 OR new.INCIDENT_ID=421 OR new.INCIDENT_ID=423) then
BEGIN 
STYPE='goal';
END
else IF(new.INCIDENT_ID=418) then
BEGIN 
STYPE='rcard';
END
else IF(new.INCIDENT_ID=419) then
BEGIN
 STYPE='ycard';
END 
else IF(new.INCIDENT_ID=405) then
BEGIN 
STYPE='Shot on target';
END
else IF(new.INCIDENT_ID=410) then
BEGIN
 STYPE='Foul';
END 
else IF(new.INCIDENT_ID=408) then
BEGIN 
STYPE='Corner';
END
else IF(new.INCIDENT_ID=416) then
BEGIN
 STYPE='Offside';
END 
else IF(new.INCIDENT_ID=400) then
BEGIN 
STYPE='In possession';
END 
else IF(new.INCIDENT_ID=450) then
BEGIN 
STYPE='Substitution out';
END 
else IF(new.INCIDENT_ID=452) then
BEGIN 
STYPE='Substitution in';
END 
else IF(new.INCIDENT_ID=422) then
BEGIN 
--Missed penalty 3 21 2019
 --delete  from MATCHDETAILS  m where m.EMATCHID=new.EVENTID and m.INCIDENTS_ID=( select first 1 i.ID from INCIDENTS  i where i.EVENTID=new.EVENTID   and i.PARTICIPANT_ID=new.PARTICIPANT_ID and  i.INCIDENT_ID=421  order by i.CTIMESTAMP desc  );
---update  MATCHDETAILS  m set m.N=0 where m.EMATCHID=new.EVENTID and m.INCIDENTS_ID=( select first 1 i.ID from INCIDENTS  i where i.EVENTID=new.EVENTID   and i.PARTICIPANT_ID=new.PARTICIPANT_ID and  i.INCIDENT_ID=421  order by i.CTIMESTAMP desc  );

END 
else IF(new.INCIDENT_ID=424) then
BEGIN 
--incident_id="424" incident_name="Goal cancelled  3 26 2019
 --delete  from MATCHDETAILS  m where m.EMATCHID=new.EVENTID and m.INCIDENTS_ID=( select  first 1 i.ID from INCIDENTS  i where i.EVENTID=new.EVENTID  and i.PARTICIPANT_ID=new.PARTICIPANT_ID and i.INCIDENT_ID=413  order by i.CTIMESTAMP desc  );
 ---update  MATCHDETAILS  m set  m.N=0  where m.EMATCHID=new.EVENTID and m.INCIDENTS_ID=( select  first 1 i.ID from INCIDENTS  i where i.EVENTID=new.EVENTID  and i.PARTICIPANT_ID=new.PARTICIPANT_ID and i.INCIDENT_ID=413  order by i.CTIMESTAMP desc  );
END 

:playername=null;
:eplayername=new.SUBPARTICIPANT_NAME;
if(new.PARTICIPANT_ID is not null and new.SUBPARTICIPANT_ID is not null  and new.SUBPARTICIPANT_NAME is not null
and new.PARTICIPANT_ID !='' and new.SUBPARTICIPANT_ID !='' and new.SUBPARTICIPANT_NAME !='') then
 begin 
 ----INSERT INTO GOALINFO_LOG (EMATCHID, LASTTIME, GAMESTATUS, ELAPSED, LOG_TYPE, AID)VALUES  (new.EVENTID,new.CTIMESTAMP,new.SUBPARTICIPANT_ID||'/'||new.SUBPARTICIPANT_NAME, 
 ----cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR 2) as integer)+1 ,'insertCN','SELECT first 1 name_cn FROM players WHERE id= cast('||new.SUBPARTICIPANT_ID||' as integer)') ;

  --add current player to players table
 --UPDATE OR INSERT INTO  players ( ID,NAME,TEAM_ID,CTIMESTAMP  ) VALUES  (new.SUBPARTICIPANT_ID,new.PARTICIPANT_NAME,new.PARTICIPANT_ID,new.CTIMESTAMP ) MATCHING  (ID) ;
 --03042019
 --UPDATE OR INSERT INTO  players ( ID,NAME,NAME_CN,TEAM_ID,CTIMESTAMP  ) VALUES  (new.SUBPARTICIPANT_ID,NEW.SUBPARTICIPANT_NAME,NULL,NEW.PARTICIPANT_ID,new.CTIMESTAMP ) MATCHING  (ID,TEAM_ID,NAME) ;
--UPDATE OR INSERT INTO  players ( ID,NAME,TEAM_ID,EVENT_ID,CTIMESTAMP  ) VALUES  (new.SUBPARTICIPANT_ID,NEW.SUBPARTICIPANT_NAME,NEW.PARTICIPANT_ID,new.eventid, new.CTIMESTAMP ) MATCHING  (ID,TEAM_ID,NAME) ;
 --SELECT first 1 name_cn FROM players WHERE id=new.SUBPARTICIPANT_ID into : playername;   
 
 SELECT first 1 CPLAYER_NAME FROM PLAYERS_INFO WHERE PLAYER_ID= cast(new.SUBPARTICIPANT_ID as integer) and  CPLAYER_NAME is not null  and CPLAYER_NAME !='' into : playername;  
  if(new.INCIDENT_ID=423) then 
 begin
 :playername=:playername||'*';
 :eplayername=:eplayername||'*';
 end
 else
 begin
 UPDATE OR INSERT INTO  players ( ID,NAME,TEAM_ID,EVENT_ID,CTIMESTAMP  ) VALUES  (new.SUBPARTICIPANT_ID,NEW.SUBPARTICIPANT_NAME,NEW.PARTICIPANT_ID,new.eventid, new.CTIMESTAMP ) MATCHING  (ID,TEAM_ID,NAME) ;
  end
  
 end 
 --cast(SUBSTRING(i.EVENT_TIME FROM 1 FOR  position(':',i.EVENT_TIME)-1  ) as integer)+ case when position( ':00',i.EVENT_TIME) >0 then 0 else 1 end 
UPDATE OR INSERT INTO  MATCHDETAILS ( ID,EMATCHID,CTYPE,STATUS , LASTTIME  ,  PLAYER  ,
                         PARTICIPANTID,ELAPSED,UPDATETIME,N,INCIDENTTYPEFK , HG ,  PLAYERCHI, INCIDENTS_ID,Team_id )VALUES
                         (null,new.EVENTID, :STYPE,new.EVENT_STATUS_NAME,new.CTIMESTAMP,  :eplayername,
                         --new.SUBPARTICIPANT_ID,  cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR 2) as integer)+1, current_timestamp ,null,null,New.TeamType,:playername ,NEW.ID,NEW.PARTICIPANT_ID) MATCHING  (INCIDENTS_ID) ;
                         new.SUBPARTICIPANT_ID,  cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR  position(':',new.EVENT_TIME)-1  ) as integer)+ case when position( ':00',new.EVENT_TIME) >0 then 0 else 1 end , current_timestamp ,null,null,New.TeamType,:playername ,NEW.ID,NEW.PARTICIPANT_ID) MATCHING  (INCIDENTS_ID) ;
 end
 --429 1st half started yes
--430 2nd half started yes
--431 Extratime 1st halfstartedyes
--432 Extratime 2nd halfstartedyes
--433 Penalty shootoutstartedyes
--434 Finished afterextratimeyes
--435 Finished afterpenalties

--IF(new.STATUS_NAME='Not started') then
IF(new.EVENT_STATUS_ID=1) then
BEGIN 
sGameStatus=new.EVENT_STATUS_NAME;
END
--IF(new.STATUS_NAME='Start delayed') then
--else IF(new.EVENT_STATUS_ID=429) then
else IF(new.INCIDENT_ID=429) then
BEGIN 
sGameStatus='gamestarted';
END
else IF(new.INCIDENT_ID=430) then
BEGIN 
sGameStatus='secondhalfstarted';
END
else IF(new.INCIDENT_ID=431) then
BEGIN 
sGameStatus='extratimestarted';
END
else IF(new.INCIDENT_ID=432) then
BEGIN 
sGameStatus='extratimesecondhalfstarted';
END
else IF(new.INCIDENT_ID=437) then
BEGIN 
sGameStatus='secondhalfended';
END
else IF(new.INCIDENT_ID=445) then
BEGIN 
sGameStatus='firsthalfended';
END
--IF(new.STATUS_NAME='Halftime') then
else IF(new.EVENT_STATUS_ID=9) then
BEGIN 
sGameStatus='firsthalfended';
END
--IF(new.STATUS_NAME='Finished') then
else IF(new.EVENT_STATUS_ID=11) then
BEGIN 
sGameStatus='secondhalfended';
END
--else IF(new.STATUS_NAME='Extratime') then
else IF(new.EVENT_STATUS_ID=15) then
BEGIN 
sGameStatus='secondhalfended';
END
--else IF(new.STATUS_NAME='1st half') then
else IF(new.EVENT_STATUS_ID=33) then
BEGIN
 sGameStatus='gamestarted';
END 
--else IF(new.STATUS_NAME='2nd half') then
else IF(new.EVENT_STATUS_ID=34) then
BEGIN
 sGameStatus='secondhalfstarted';
END 
--else IF(new.STATUS_NAME='Extratime 1st half'  ) then
else IF(new.EVENT_STATUS_ID=35) then
BEGIN
 sGameStatus='extratimestarted';
END 
--else IF(new.STATUS_NAME='Extratime 2nd half'  ) then
else IF(new.EVENT_STATUS_ID=36) then
BEGIN
 sGameStatus='extratimesecondhalfstarted';
END 
--else IF(new.STATUS_NAME='Extratime halftime'  ) then
else IF(new.EVENT_STATUS_ID=37) then
BEGIN
 sGameStatus='extratimefirsthalfended';
END  
--else IF(new.STATUS_NAME='Waiting for extratime'  ) then
else IF(new.EVENT_STATUS_ID=48) then
BEGIN
 sGameStatus='secondhalfended';
END 
--else IF(new.STATUS_NAME='Penalty shootout'  ) then
else IF(new.EVENT_STATUS_ID=141) then
BEGIN
 sGameStatus='gameended';
END  
--else IF(new.STATUS_NAME='Waiting for penalty'  ) then
else IF(new.EVENT_STATUS_ID=142) then
BEGIN
 sGameStatus='gameended';
END 
else
BEGIN
 sGameStatus=new.EVENT_STATUS_NAME;
END  
--20190121 update events status
 --   STATUSID = NULL;   
 --   select id from STATUSES where name =new.INCIDENT_NAME INTO :STATUSID;
 --   if(STATUSID is not null) then 
 --   begin  
 --   UPDATE  EVENTS e set e.STATUS_ID=:STATUSID, e.STATUS_NAME=  new.EVENT_STATUS_NAME, e.CTIMESTAMP =new.CTIMESTAMP WHERE e.ID=new.EVENTID; 
 --   end 
  IF(new.INCIDENT_ID=437) then
BEGIN 
UPDATE  EVENTS e set e.STATUS_ID=11, e.STATUS_NAME='Finished', e.CTIMESTAMP =new.CTIMESTAMP WHERE e.ID=new.EVENTID; 
END

--UPDATE  GOALINFO g set  g.ELAPSED= cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR 2) as integer)+1,g.GAMESTATUS=:sGameStatus, LASTTIME =new.CTIMESTAMP WHERE  g.EMATCHID=new.EVENTID; 
 UPDATE  GOALINFO g set  g.ELAPSED=  cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR  position(':',new.EVENT_TIME)-1  ) as integer)+ case when position( ':00',new.EVENT_TIME) >0 then 0 else 1 end ,g.GAMESTATUS=:sGameStatus, LASTTIME =new.CTIMESTAMP WHERE  g.EMATCHID=new.EVENTID; 
  --log
----INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (new.ID, new.EVENTID,new.CTIMESTAMP,:sGameStatus, cast(SUBSTRING(new.EVENT_TIME FROM 1 FOR 2) as integer)+1 ,'GoalInfo') ;

END  
else  --delete 
begin 
delete  from MATCHDETAILS e where e.INCIDENTS_ID=new.ID;
end 
END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_PLAYERS_PLAYERS_INFO FOR PLAYERS ACTIVE
AFTER INSERT OR UPDATE POSITION 1
AS    
DECLARE VARIABLE iPost integer; 
DECLARE VARIABLE iPos integer; 
DECLARE VARIABLE sCnName varchar(50); 
DECLARE VARIABLE sCOUNTRY varchar(50); 
DECLARE VARIABLE sPOSITION varchar(10); 
declare variable iCount integer;
BEGIN 

select  count(m.EMATCHID) from EMATCHES m inner join events e on e.id =m.EMATCHID where e.HOME_ID=new.TEAM_ID or e.GUEST_ID =new.TEAM_ID  into:iCount;
--IF ( new.TEAM_ID is not null  and new.NAME !=''and new.ID!=-1 ) THEN  
IF (  iCount>0  and  new.TEAM_ID is not null  and new.NAME !='' ) THEN  
begin  
if(new.BENCH =true) then
begin
iPost=0;
end
else 
begin
iPost=1;
end

iPos=0;
sCnName='';
sCOUNTRY='';
sPOSITION='';

if(new.NAME_CN is not null and  new.NAME_CN !=''  ) then
begin
sCnName=new.NAME_CN;
end
else 
begin  
select first 1 p.PLAYER_CHI_NAME,p.COUNTRY_CHI_NAME,p."POSITION" from INT_PLAYER p where p.SHIRT_NO=new.SHIRT_NR
  and p.TEAM_CHI_NAME=(select t.HKJC_NAME_CN from  TEAMS t where  t.id =new.TEAM_ID   )  
  into :sCnName, : sCOUNTRY,:sPOSITION; 
 if(:sPOSITION='eW') then
begin
iPos=0;
end
else if(:sPOSITION='') then
begin
iPos=1;
end
else if(:sPOSITION='') then
begin
iPos=2;
end
else if(:sPOSITION='u') then
begin
iPos=3;
end
else 
begin
iPos=4;
end

if(sCnName is null or sCnName='' ) then
begin 
select first 1 x.CPLAYER_NAME,x.CCOUNTRY  from PLAYERS_INFO x  where (x.PLAYER_ID =new.ID and new.ID!=-1 ) or ( x.CENGNAME=new.NAME and new.ID=-1)   into :sCnName, : sCOUNTRY;
end 

end
 
  UPDATE OR INSERT INTO  PLAYERS_INFO  ( event_id,TEAM_ID,PLAYER_ID,IPLAYER_NO,CPLAYER_NAME,CCOUNTRY,IPOS,IROSTER,CENGNAME,CTIMESTAMP) VALUES 
 (new.EVENT_ID,new.TEAM_ID, NEW.ID,NEW.SHIRT_NR,:sCnName, :sCOUNTRY,:iPos,:iPost,NEW.NAME, current_timestamp) MATCHING  ( TEAM_ID,PLAYER_ID,CENGNAME) ;

end
 END^
SET TERM ; ^
SET TERM ^ ;
CREATE TRIGGER TR_PSTATS_ANALYSISOTHERS FOR PARTICIPANT_STATS ACTIVE
AFTER INSERT OR UPDATE POSITION 0
AS     
DECLARE VARIABLE sLeague varchar(12); 
DECLARE VARIABLE sTeam varchar(50); 

BEGIN 
IF ( new.CACTION is not null  and new.CACTION !='delete' ) THEN  
begin  
--sLeague='';
--sTeam='';
select FIRST 1  c.alias,t.HKJC_NAME_CN from events e inner join EMATCHES m on m.EMATCHID=e.id  inner join COMPETITIONS c on   e.COMPETITION_ID=c.id  inner join teams t on t.id =new.PARTICIPANTID
 where e.ID=new.EVENTID and (e.HOME_ID =new.PARTICIPANTID or e.GUEST_ID=new.PARTICIPANTID) ORDER BY M.CTIMESTAMP DESC into :sLeague, : sTeam; 
 
 if(:sLeague is not null and :sTeam is not null ) then
 begin
UPDATE OR INSERT INTO  ANALYSIS_OTHERS (EVENTID, CLEAGUE, CTEAM,CTEAMTYPE, CACTION, CSHOTS, CFOULS,  CCORNER_KICKS, COFFSIDES, CPOSSESSION, CYELLOW_CARDS, CRED_CARDS,CAttacks,CSubstitutions,CThrowins,CGoalkicks,CTIMESTAMP)
VALUES  ( NEW.EVENTID,:sLeague,:sTeam,NEW.TEAMTYPE,'U',NEW.TOTAL_SHOTS_19||','||NEW.SOT_20,NEW.FOULS_22,NEW.CORNERS_13,NEW.OFFSIDES_24,'-',new.YELLOW_CARDS_8,new.RED_CARDS_9,NEW.ATTACKS_10,NEW.SUBSTITUTIONS_31,
NEW.TI_32,NEW.GK_30,current_timestamp) MATCHING  ( EVENTID,CTEAM,CTEAMTYPE) ;
 end
end
 END^
SET TERM ; ^

SET TERM ^ ;
ALTER PROCEDURE ADD_ANALYSIS_HISTORY_INFO (
    IMATCH_CNT Integer,
    IREC Integer,
    CACT Varchar(1),
    EVENTID Integer,
    HOME_ID Integer,
    GUEST_ID Integer,
    START_DATE Timestamp,
    LEAGUEALIASID Integer,
    IMATCHMONTH Integer,
    IMATCHYEAR Integer,
    IMATCHSTATUS Integer,
    IHOSTSCORE Integer,
    IGUESTSCORE Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE sAlias Varchar(8); 
BEGIN
    select  c.ALIAS  from COMPETITIONS c   where  c.ID=:LEAGUEALIASID   into :sAlias;  
     UPDATE OR INSERT INTO  ANALYSIS_HISTORY_INFO   (IMATCH_CNT, IREC ,CACT,EVENTID,HOME_ID,GUEST_ID,START_DATE,LEAGUEALIASID,LEAGUEALIAS,IMATCHMONTH, IMATCHYEAR,IMATCHSTATUS,IHOSTSCORE,IGUESTSCORE,CTIMESTAMP)VALUES
      (:IMATCH_CNT, :IREC ,:CACT,:EVENTID,:HOME_ID,:GUEST_ID,:START_DATE,:LEAGUEALIASID,:sAlias,:IMATCHMONTH, :IMATCHYEAR,:IMATCHSTATUS,:IHOSTSCORE,:IGUESTSCORE,:CTIMESTAMP) MATCHING  (IMATCH_CNT,IREC)  RETURNING IMATCH_CNT INTO :Result ;
 END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_ANALYSIS_RECENT_INFO (
    IMATCH_CNT Integer,
    IREC Integer,
    CACT Varchar(1),
    EVENTID Integer,
    START_DATE Timestamp,
    LEAGUEALIAS Varchar(8),
    CTEAMFLAG Varchar(1),
    CCHALLENGER Varchar(8),
    IMATCHSTATUS Integer,
    IHOSTSCORE Integer,
    IGUESTSCORE Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE sTeamName varchar(50); 
BEGIN
     select  t.HKJC_NAME_CN from teams t   where  t.ID=cast(:CCHALLENGER  as integer)   into :sTeamName; 
     UPDATE OR INSERT INTO  ANALYSIS_RECENT_INFO   (IMATCH_CNT, IREC ,CACT,EVENTID,START_DATE,LEAGUEALIAS,CTEAMFLAG, CCHALLENGER,IMATCHSTATUS,IHOSTSCORE,IGUESTSCORE,CTIMESTAMP)VALUES
      (:IMATCH_CNT, :IREC ,:CACT,:EVENTID,:START_DATE,:LEAGUEALIAS,:CTEAMFLAG, :sTeamName,:IMATCHSTATUS,:IHOSTSCORE,:IGUESTSCORE,:CTIMESTAMP) MATCHING  (IMATCH_CNT,IREC)  RETURNING IMATCH_CNT INTO :Result ;
 END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_ANALYSIS_STAT_INFO (
    IMATCH_CNT Integer,
    CACT Varchar(1),
    IHOSTWIN Integer,
    IHOSTDRAW Integer,
    IHOSTLOSS Integer,
    IGUESTWIN Integer,
    IGUESTDRAW Integer,
    IGUESTLOSS Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  HOME_ID integer; 
DECLARE VARIABLE  GUEST_ID integer; 
DECLARE VARIABLE  SEASON_ID integer; 
DECLARE VARIABLE  GAMES integer; 
DECLARE VARIABLE  IWON integer; 
DECLARE VARIABLE  IDRAW integer; 
DECLARE VARIABLE  ILOST integer; 
BEGIN 
   Result= null; 
   select first 1 e.HOME_ID,e.GUEST_ID,e.SEASON_ID from  EVENTS  e  where e.ID=:IMATCH_CNT INTO :HOME_ID,:GUEST_ID,:SEASON_ID;
   
   SELECT first 1 a.GAMES, a.IWON, a.IDRAW, a.ILOST FROM LEAGRANKINFO a where a.TEAM_ID=:HOME_ID and a.SEASON_ID=:SEASON_ID order by a.SEASON_ID desc 
   INTO :GAMES,:IWON,IDRAW,ILOST; 
  if (:GAMES is not null and :GAMES>0) then
  begin
    UPDATE OR INSERT INTO  ANALYSIS_STAT_INFO   (IMATCH_CNT, CACT,IHOSTWIN,IHOSTDRAW,IHOSTLOSS,CTIMESTAMP)VALUES 
    -- cast( 1*100/ cast(3 as decimal(3,2))as decimal(3,1))
    -- (:IMATCH_CNT,:CACT,(:IWON*100/:GAMES) ,(:IDRAW*100/:GAMES),(:ILOST*100/:GAMES), :CTIMESTAMP) MATCHING  (IMATCH_CNT)  RETURNING IMATCH_CNT INTO :Result ;
    (:IMATCH_CNT,:CACT, cast(:IWON*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)) , cast(:IDRAW*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)), cast(:ILOST*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)), :CTIMESTAMP) 
    MATCHING  (IMATCH_CNT)  RETURNING IMATCH_CNT INTO :Result ;
   end
   
    SELECT first 1 a.GAMES, a.IWON, a.IDRAW, a.ILOST FROM LEAGRANKINFO a where a.TEAM_ID=:GUEST_ID and a.SEASON_ID=:SEASON_ID order by a.SEASON_ID desc 
   INTO :GAMES,:IWON,IDRAW,ILOST; 
  if (:GAMES is not null and  :GAMES>0) then
  begin
    UPDATE OR INSERT INTO  ANALYSIS_STAT_INFO   (IMATCH_CNT, CACT,IGUESTWIN,IGUESTDRAW,IGUESTLOSS,CTIMESTAMP)VALUES
   --  (:IMATCH_CNT,:CACT,(:IWON*100/:GAMES) ,(:IDRAW*100/:GAMES),(:ILOST*100/:GAMES), :CTIMESTAMP) MATCHING  (IMATCH_CNT)  RETURNING IMATCH_CNT INTO :Result ;
    (:IMATCH_CNT,:CACT, cast(:IWON*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)) , cast(:IDRAW*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)), cast(:ILOST*100/ cast(:GAMES as decimal(3,2))as decimal(3,1)), :CTIMESTAMP) 
    MATCHING  (IMATCH_CNT)  RETURNING IMATCH_CNT INTO :Result ;
  end
   if(Result is  null) then
   begin
   :Result=0;
   end
 END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_AREA7 (
    ID Integer,
    AREA_CODE Varchar(5),
    NAME Varchar(100),
    PARENT_AREA_ID Integer,
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM AREAS2 WHERE id= :ID into :Result;
   IF (Result is NULL) then
 INSERT INTO AREAS2(ID, AREA_CODE,  NAME ,  PARENT_AREA_ID ,  UT  ,  CTIMESTAMP)VALUES  (:ID, :AREA_CODE, :NAME  , :PARENT_AREA_ID, :UT  , :CTIMESTAMP )  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_COMPETITION (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    MINI_NAME Varchar(50),
    GENDER ,
    CTYPE Varchar(50),
    AREA_ID Integer,
    AREA_TYPE Varchar(50),
    AREA_SORT Integer,
    OVERALL_SORT Integer,
    TOUR_ID Integer,
    TOUR_NAME Varchar(50),
    UT Varchar(12),
    OLD_COMPETITION_ID Integer,
    SLUG Varchar(100),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM COMPETITIONS WHERE id= :ID into :Result;
   IF (Result is NULL) then
 INSERT INTO COMPETITIONS(id ,   name ,         short_name ,         mini_name  ,         gender     ,         ctype  ,         area_id  ,          area_type  ,         area_sort  ,          overall_sort ,           tour_id  ,         tour_name  ,         ut  ,         old_competition_id  ,         slug  ,         ctimestamp)
VALUES  (:id ,
         :name ,
         :short_name ,
         :mini_name  ,
         :gender     ,
         :ctype  ,
         :area_id  , 
         :area_type  ,
         :area_sort  , 
         :overall_sort , 
         :tour_id  ,
         :tour_name  ,
        :ut  ,
         :old_competition_id  ,
         :slug  ,
         :ctimestamp)  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_GROUP (
    ID Integer,
    NAME Varchar(30),
    UT Varchar(12),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM GROUPS WHERE id= :ID and STAGE_ID =:STAGE_ID    and SEASON_ID =:SEASON_ID   and COMPETITION_ID =:COMPETITION_ID  into :Result;
   IF (Result is NULL) then
 INSERT INTO GROUPS(ID ,
  NAME ,
  UT ,
  STAGE_ID ,
  SEASON_ID ,
  COMPETITION_ID,
  AREA_ID ,
  CTIMESTAMP )
VALUES  (:ID ,
 :NAME ,
 :UT ,
 :STAGE_ID ,
 :SEASON_ID ,
 :COMPETITION_ID,
  :AREA_ID ,
  :CTIMESTAMP )  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_HKJCMATCH (
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    HKJCHOSTNAME_CN Varchar(100),
    HKJCGUESTNAME_CN Varchar(100),
    CLEAGUE_HKJC_NAME Varchar(30),
    LEAGUE_OUTPUT_NAME Varchar(30),
    LEAGUEALIAS_OUTPUT_NAME Varchar(10),
    CLEAGUE_SHT_ENG_NAME Varchar(5),
    CLEAGUE_ENG_NAME Varchar(99),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT count(*) FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME
    AND CMATCHDATETIME=:CMATCHDATETIME  into :Result;
IF (Result = 0) then
begin
 INSERT INTO EMATCHES( 
  HKJCMATCHNO ,
  HKJCDAYCODE , 
  CMATCHDATETIME , 
  HKJCHOSTID ,
  HKJCGUESTID ,
  HKJCHOSTNAME ,
  HKJCGUESTNAME ,
    HKJCHOSTNAME_CN,
  HKJCGUESTNAME_CN ,
  CLEAGUE_HKJC_NAME,
  CLEAGUE_OUTPUT_NAME,
  CLEAGUEALIAS_OUTPUT_NAME,
  CLEAGUE_SHT_ENG_NAME,
  CLEAGUE_ENG_NAME,
  STATUS,
  MAPPINGSTATUS,
  CTIMESTAMP )
VALUES  ( 
  :HKJCMATCHNO ,
  :HKJCDAYCODE , 
  :CMATCHDATETIME , 
  :HKJCHOSTID ,
  :HKJCGUESTID ,
  :HKJCHOSTNAME ,
  :HKJCGUESTNAME ,
   :HKJCHOSTNAME_CN,
  :HKJCGUESTNAME_CN ,
  :CLEAGUE_HKJC_NAME,
  :LEAGUE_OUTPUT_NAME,
  :LEAGUEALIAS_OUTPUT_NAME,
  :CLEAGUE_SHT_ENG_NAME,
  :CLEAGUE_ENG_NAME,
  :STATUS,
  --null,
  :MAPPINGSTATUS,
  :CTIMESTAMP  )  ;
-- RETURNING EMATCHID  INTO :RESULT; 
 RESULT=0; 
 end 
ELSE 
begin
 UPDATE  EMATCHES set CMATCHDATETIME=:CMATCHDATETIME, CTIMESTAMP =:CTIMESTAMP, HKJCHOSTNAME_CN =:HKJCHOSTNAME_CN,HKJCGUESTNAME_CN=:HKJCGUESTNAME_CN ,
 CLEAGUE_OUTPUT_NAME=:LEAGUE_OUTPUT_NAME,  CLEAGUEALIAS_OUTPUT_NAME=:LEAGUEALIAS_OUTPUT_NAME
 WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME AND CMATCHDATETIME=:CMATCHDATETIME;-- RETURNING EMATCHID  INTO :Result; 
-- SELECT EMATCHID FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME and EMATCHID is not null into :Result;
  RESULT=1 ;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_HKJCMATCH2 (
    EMATCHID Integer,
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT EMATCHID FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME into :Result;
   IF (Result is NULL) then
 INSERT INTO EMATCHES(EMATCHID  ,
  HKJCMATCHNO ,
  HKJCDAYCODE , 
  CMATCHDATETIME , 
  HKJCHOSTID ,
  HKJCGUESTID ,
  HKJCHOSTNAME ,
  HKJCGUESTNAME ,
  STATUS,
  MAPPINGSTATUS,
  CTIMESTAMP )
VALUES  (:EMATCHID  ,
  :HKJCMATCHNO ,
  :HKJCDAYCODE , 
  :CMATCHDATETIME , 
  :HKJCHOSTID ,
  :HKJCGUESTID ,
  :HKJCHOSTNAME ,
  :HKJCGUESTNAME ,
  :STATUS,
  :MAPPINGSTATUS,
  :CTIMESTAMP  )  RETURNING EMATCHID  INTO :Result;
ELSE 
UPDATE  EMATCHES set  STATUS=:STATUS, CTIMESTAMP =:CTIMESTAMP WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME
 RETURNING EMATCHID  INTO :Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_HKJCMATCH4 (
    EMATCHID Integer,
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT count(*) FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME into :Result;
IF (Result = 0) then
begin
 INSERT INTO EMATCHES(EMATCHID  ,
  HKJCMATCHNO ,
  HKJCDAYCODE , 
  CMATCHDATETIME , 
  HKJCHOSTID ,
  HKJCGUESTID ,
  HKJCHOSTNAME ,
  HKJCGUESTNAME ,
  STATUS,
  MAPPINGSTATUS,
  CTIMESTAMP )
VALUES  (:EMATCHID  ,
  :HKJCMATCHNO ,
  :HKJCDAYCODE , 
  :CMATCHDATETIME , 
  :HKJCHOSTID ,
  :HKJCGUESTID ,
  :HKJCHOSTNAME ,
  :HKJCGUESTNAME ,
  :STATUS,
  :MAPPINGSTATUS,
  :CTIMESTAMP  )  
 RETURNING EMATCHID  INTO :RESULT;
 
IF (RESULT is null)  then
begin
 RESULT=0;
end
 end 
ELSE 
begin
UPDATE  EMATCHES set  STATUS=:STATUS, CTIMESTAMP =:CTIMESTAMP WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME RETURNING EMATCHID  INTO :Result; 
 
IF (RESULT is null)  then
begin
 RESULT=1;
 end
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_HKJCMATCH_BAK (
    HKJCMATCHNO Integer,
    HKJCDAYCODE Varchar(3),
    CMATCHDATETIME Timestamp,
    HKJCHOSTID Integer,
    HKJCGUESTID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    STATUS Varchar(15),
    MAPPINGSTATUS ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT count(*) FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME into :Result;
IF (Result = 0) then
begin
 INSERT INTO EMATCHES( 
  HKJCMATCHNO ,
  HKJCDAYCODE , 
  CMATCHDATETIME , 
  HKJCHOSTID ,
  HKJCGUESTID ,
  HKJCHOSTNAME ,
  HKJCGUESTNAME ,
  STATUS,
  MAPPINGSTATUS,
  CTIMESTAMP )
VALUES  ( 
  :HKJCMATCHNO ,
  :HKJCDAYCODE , 
  :CMATCHDATETIME , 
  :HKJCHOSTID ,
  :HKJCGUESTID ,
  :HKJCHOSTNAME ,
  :HKJCGUESTNAME ,
  :STATUS,
  --null,
  :MAPPINGSTATUS,
  :CTIMESTAMP  )  ;
-- RETURNING EMATCHID  INTO :RESULT; 
 RESULT=0; 
 end 
ELSE 
begin
 UPDATE  EMATCHES set   CTIMESTAMP =:CTIMESTAMP WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME;-- RETURNING EMATCHID  INTO :Result; 
 SELECT EMATCHID FROM EMATCHES  WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME and EMATCHID is not null into :Result;
  if(Result=null) then
   begin
--  UPDATE  EMATCHES set  STATUS=:STATUS, CTIMESTAMP =:CTIMESTAMP WHERE HKJCMATCHNO =:HKJCMATCHNO and HKJCDAYCODE =:HKJCDAYCODE AND  HKJCHOSTNAME  =:HKJCHOSTNAME AND HKJCGUESTNAME =:HKJCGUESTNAME;-- RETURNING EMATCHID  INTO :Result; 
  RESULT=1 ;
  end
   else if(Result=0) then
  begin
  RESULT=1 ;
    end
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_PLAYER (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    BIRTHDATE Varchar(12),
    POSITION_NAME Varchar(20),
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    BENCH ,
    SHIRT_NR Integer,
    TEAM_ID Integer,
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM PLAYERS WHERE TEAM_ID=:TEAM_ID and id= :ID and name=:NAME  into :Result;
   IF (Result is NULL) then
 INSERT INTO PLAYERS (ID ,
  NAME,
  SHORT_NAME,
  ACRONYM ,
  GENDER ,
  BIRTHDATE ,
  POSITION_NAME ,
  AREA_ID ,
  BNATIONAL ,
  UT ,
  OLD_PARTICIPANT_ID,
  SLUG ,
    bench  ,
  shirt_nr  ,
 TEAM_ID,
  SEASON_ID ,
  CTIMESTAMP )
VALUES  (:ID ,
  :NAME,
 : SHORT_NAME,
 : ACRONYM ,
 : GENDER ,
:  BIRTHDATE ,
 : POSITION_NAME ,
 : AREA_ID ,
 : BNATIONAL ,
 : UT ,
 : OLD_PARTICIPANT_ID,
 : SLUG ,
  : bench  ,
 : shirt_nr  ,
:TEAM_ID,
  :SEASON_ID ,
  :CTIMESTAMP  )  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_PLAYER2 (
    ID Integer,
    NAME Varchar(100),
    AREA_ID Integer,
    SLUG Varchar(100),
    BENCH ,
    SHIRT_NR Integer,
    TEAM_ID Integer,
    SEASON_ID Integer,
    EVENT_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM PLAYERS WHERE TEAM_ID=:TEAM_ID and id= :ID and name=:NAME  into :Result;
   IF (Result is NULL) then
 INSERT INTO PLAYERS (ID ,
  NAME, 
  AREA_ID , 
  SLUG ,
    bench  ,
  shirt_nr  ,
 TEAM_ID,
  SEASON_ID ,
  EVENT_ID,
  CTIMESTAMP )
VALUES  (:ID ,
  :NAME, 
 : AREA_ID , 
 : SLUG ,
  : bench  ,
 : shirt_nr  ,
:TEAM_ID,
  :SEASON_ID ,
  :EVENT_ID,
  :CTIMESTAMP  )  RETURNING ID INTO :Result;
else

UPDATE  PLAYERS set  NAME=:NAME , AREA_ID= :AREA_ID, SLUG=:SLUG, shirt_nr  =:shirt_nr   ,bench  =:bench  ,SEASON_ID=:SEASON_ID , EVENT_ID=:EVENT_ID, ctimestamp =:ctimestamp WHERE TEAM_ID=:TEAM_ID and id= :ID and name=:NAME  RETURNING id INTO :Result; 

END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_RANK_INFO (
    LEAG_ID Integer,
    CLEAG_ALIAS Varchar(8),
    SEASON_ID Integer,
    GROUP_ID Integer,
    TEAM_ID Integer,
    TEAM Varchar(50),
    HKJC_TEAM Varchar(10),
    SCORE Integer,
    RANK Integer,
    FLAG Varchar(1),
    GAMES Integer,
    IWON Integer,
    IDRAW Integer,
    ILOST Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN 
  Result = NULL;  
  UPDATE OR INSERT INTO LEAGRANKINFO (
   LEAG_ID  ,
  CLEAG_ALIAS	,
  SEASON_ID,
  GROUP_ID,
  TEAM_ID	,
  TEAM	,
   HKJC_TEAM	,
 SCORE,
 RANK,
 FLAG	,
  GAMES	,
  iwon,
  idraw,
  ilost,
  CTIMESTAMP )
VALUES  (
 :LEAG_ID  ,
   :CLEAG_ALIAS	,
   :SEASON_ID,
   :GROUP_ID,
   :TEAM_ID	,
   :TEAM	,
    :HKJC_TEAM	,
  :SCORE,
  :RANK,
  :FLAG	,
   :GAMES	,
   :iwon,
  :idraw,
  :ilost,
  : CTIMESTAMP  )  MATCHING   (LEAG_ID,SEASON_ID,TEAM_ID)      RETURNING   TEAM_ID INTO :Result;  
   
   IF (Result is NULL) then
   begin
   Result=0;
   end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_SCORERS_INFO (
    CLEAG_ID Integer,
    CLEAG_ALIAS Varchar(8),
    SEASON_ID Integer,
    TEAM_ID Integer,
    PLAYER_ID Integer,
    CPLAYER_NAME Varchar(50),
    CTEAM_ABBR Varchar(4),
    CACT Varchar(1),
    IRID Integer,
    IRANK Integer,
    IGOALS Integer,
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN 
  Result = NULL;  
  UPDATE OR INSERT INTO SCORERS_INFO (
   CLEAG_ID,
  CLEAG_ALIAS,
  SEASON_ID,
  TEAM_ID,
  PLAYER_ID,
 CPLAYER_NAME,
 CTEAM_ABBR ,
  CACT,
 IRID,
  IRANK,
  IGOALS,
  ut,
  CTIMESTAMP )
VALUES  (
:CLEAG_ID,
  :CLEAG_ALIAS,
  :SEASON_ID,
  :TEAM_ID,
  :PLAYER_ID,
 :CPLAYER_NAME,
 :CTEAM_ABBR,
  :CACT,
 :IRID,
 :IRANK,
  :IGOALS,
    :ut,
  :CTIMESTAMP  )  MATCHING   (CLEAG_ID,SEASON_ID,TEAM_ID,CPLAYER_NAME)      RETURNING   PLAYER_ID INTO :Result;  
   
   IF (Result is NULL) then
   begin
   Result=0;
   end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_SEASON (
    ID Integer,
    NAME Varchar(100),
    COMPETITION_ID Integer,
    SYEAR Varchar(10),
    ACTUAL Varchar(10),
    UT Varchar(12),
    OLD_SEASON_ID Integer,
    RANGE Varchar(10),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM SEASONS WHERE id= :ID into :Result;
   IF (Result is NULL) then
 INSERT INTO SEASONS (id ,   name ,  COMPETITION_ID , SYEAR ,   ACTUAL ,  UT   ,OLD_SEASON_ID   , RANGE , CTIMESTAMP )
VALUES  (:id ,   :name ,  :COMPETITION_ID , :SYEAR ,   :ACTUAL ,  :UT   ,:OLD_SEASON_ID   , :RANGE ,:CTIMESTAMP)  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_STAGE (
    ID Integer,
    STAGE_NAME_ID Integer,
    NAME Varchar(50),
    START_DATE Varchar(12),
    END_DATE Varchar(12),
    SHOW_STANDINGS ,
    GROUPS_NR Integer,
    ISORT Integer,
    IS_CURRENT ,
    UT Varchar(12),
    OLD_STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM STAGES WHERE id= :ID into :Result;
   IF (Result is NULL) then
 INSERT INTO STAGES (ID ,
  STAGE_NAME_ID ,
  NAME  ,
  START_DATE ,
  END_DATE ,
  SHOW_STANDINGS ,
  GROUPS_NR ,
  ISORT ,
  IS_CURRENT ,
  UT  ,
  OLD_STAGE_ID ,
  SEASON_ID ,
  COMPETITION_ID ,
  AREA_ID ,
  CTIMESTAMP)
VALUES  (:ID ,
  :STAGE_NAME_ID ,
  :NAME  ,
  :START_DATE ,
:END_DATE ,
  :SHOW_STANDINGS ,
:GROUPS_NR ,
 :ISORT ,
 :IS_CURRENT ,
 :UT  ,
 :OLD_STAGE_ID ,
  :SEASON_ID ,
  :COMPETITION_ID ,
 :AREA_ID ,
  :CTIMESTAMP)  RETURNING ID INTO :Result;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_STANDINGS (
    ID Integer,
    COMPETITION_ID Integer,
    CCOMPNAME Varchar(99),
    OBJECT_ID Integer,
    OBJECT_NAME Varchar(50),
    OBJECT_TYPE Varchar(10),
    SUBTYPE Varchar(10),
    TYPE_NAME Varchar(30),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE sid integer; 
BEGIN 
  Result = NULL;
  if(:OBJECT_TYPE='stage')   then
  begin
  SELECT SEASON_ID FROM STAGES WHERE ID=:OBJECT_ID  into :sid; 
     end
  else   
     begin
    :sid=:object_id; 
     end 
  UPDATE OR INSERT INTO STANDINGS_INFO (
  ID ,
  Competition_ID ,
  SEASON_ID,
  CCompName ,
  object_id,
  object_name,
  object_type ,
  subtype,
  type_name ,
  ut,
  CTIMESTAMP )
VALUES  (
:ID ,
  :Competition_ID ,
  :sid,
  :CCompName ,
 :object_id,
 :object_name,
  :object_type ,
  :subtype,
 :type_name ,
 :ut,
 :CTIMESTAMP  )  MATCHING   (ID,Competition_ID)      RETURNING   ID INTO :Result;  
   
   IF (Result is NULL) then
   begin
   Result=0;
   end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_TEAM (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL; 
    SELECT ID FROM TEAMS WHERE id= :ID into :Result;
   IF (Result is NULL) then
   begin
 INSERT INTO TEAMS (ID ,
  NAME ,
  SHORT_NAME ,
  ACRONYM,
  GENDER,
  AREA_ID ,
  BNATIONAL,
  UT ,
  OLD_PARTICIPANT_ID,
  SLUG,
  SEASON_ID ,
  CTIMESTAMP )
VALUES  (:ID ,
  : NAME ,
  : SHORT_NAME ,
 :  ACRONYM,
 :  GENDER,
  : AREA_ID ,
  : BNATIONAL,
  : UT ,
  : OLD_PARTICIPANT_ID,
  : SLUG,
  : SEASON_ID ,
   :CTIMESTAMP   ) ;--RETURNING ID INTO :Result;
   :Result=1;
   end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE ADD_TEAM2 (
    ID Integer,
    NAME Varchar(100),
    SHORT_NAME Varchar(50),
    ACRONYM Varchar(3),
    GENDER ,
    AREA_ID Integer,
    BNATIONAL ,
    UT Varchar(50),
    OLD_PARTICIPANT_ID Integer,
    SLUG Varchar(100),
    SEASON_ID Integer,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN 
  Result = NULL;  
  UPDATE OR INSERT INTO TEAMS (ID ,
  NAME ,
  SHORT_NAME ,
  ACRONYM,
  GENDER,
  AREA_ID ,
  BNATIONAL,
  UT ,
  OLD_PARTICIPANT_ID,
  SLUG,
  SEASON_ID ,
  CTIMESTAMP )
VALUES  (:ID ,
  : NAME ,
  : SHORT_NAME ,
 :  ACRONYM,
 :  GENDER,
  : AREA_ID ,
  : BNATIONAL,
  : UT ,
  : OLD_PARTICIPANT_ID,
  : SLUG,
  : SEASON_ID ,
   :CTIMESTAMP  ) MATCHING  (ID);--   RETURNING   ID INTO :Result; 
   
  SELECT first 1  ID FROM TEAMS WHERE id= :ID  and SEASON_ID=:SEASON_ID into :Result;
   
   IF (Result is NULL) then
   begin
   Result=0;
   end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE DELETEEVENT_BYID (
    ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN 
delete from events e where e.ID=:id;
RESULT=0;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE DELETE_INCIDENTS_BYEVENTID (
    ID Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN 
delete from INCIDENTS I where  I.EVENTID=:ID;
delete from MATCHDETAILS m where  m.EMATCHID=:id;
RESULT=0;
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_EVENT_DETAILS (
    EVENTID Integer,
    WC_8 Varchar(20),
    PC_36 Varchar(20),
    PL_16 Varchar(3),
    EPL_50 Varchar(3),
    NOP_17 Varchar(1),
    EPTC_58 Varchar(100),
    IT_151 Varchar(2),
    ATT_141 Varchar(50),
    FHSD_19 Timestamp,
    SHSD_20 Timestamp,
    FEHSD_44 Timestamp,
    SEHSD_45 Timestamp,
    PSSD_150 Timestamp,
    FHIT_201 Varchar(2),
    SHIT_202 Varchar(2),
    FEHIT_203 Varchar(2),
    SEHIT_204 Varchar(2),
    HL_205 Varchar(8),
    TD_124 Varchar(4),
    BM_160 Varchar(4),
    HF_178 Varchar(4),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
--DECLARE VARIABLE Result2 Integer; 
BEGIN
    
    Result = NULL;   
     SELECT EVENTID FROM event_details WHERE EVENTID=:EVENTID and ut>:ut  into :Result; 
    IF (Result is NULL) then 
    Begin
    UPDATE OR INSERT INTO   event_details ( 
EVENTID,
  WC_8 ,
  PC_36 ,
  PL_16 ,
  EPL_50 ,
  NOP_17,
  EPTC_58,
  IT_151 ,
  ATT_141,
  FHSD_19 ,
  SHSD_20 ,
  FEHSD_44 ,
  SEHSD_45,
  PSSD_150 ,
  FHIT_201,
  SHIT_202 ,
  FEHIT_203 ,
  SEHIT_204,
  HL_205 ,
  TD_124 ,
  BM_160 ,
  HF_178 ,
  UT ,
  CTIMESTAMP)VALUES
      (  :EVENTID,
  :WC_8 ,
  :PC_36 ,
  :PL_16 ,
  :EPL_50 ,
  :NOP_17,
  :EPTC_58,
  :IT_151 ,
  :ATT_141,
  :FHSD_19 ,
  :SHSD_20 ,
  :FEHSD_44 ,
  :SEHSD_45,
  :PSSD_150 ,
  :FHIT_201,
  :SHIT_202 ,
 :FEHIT_203 ,
  :SEHIT_204,
  :HL_205 ,
  :TD_124 ,
  :BM_160 ,
  :HF_178 ,
  :UT ,
  :CTIMESTAMP )  MATCHING  ( EVENTID)  RETURNING EVENTID INTO :Result; 
   IF (Result is NULL) then 
   Begin
   Result=-1;
   end
  
  end
   ELSE   
    begin
    Result=0;
    end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_EVENT_DETAILS_BAK (
    EVENTID Integer,
    WC_8 Varchar(20),
    PC_36 Varchar(20),
    PL_16 Varchar(3),
    EPL_50 Varchar(3),
    NOP_17 Varchar(1),
    EPTC_58 Varchar(100),
    IT_151 Varchar(2),
    ATT_141 Varchar(50),
    FHSD_19 Timestamp,
    SHSD_20 Timestamp,
    FEHSD_44 Timestamp,
    SEHSD_45 Timestamp,
    PSSD_150 Timestamp,
    FHIT_201 Varchar(2),
    SHIT_202 Varchar(2),
    FEHIT_203 Varchar(2),
    SEHIT_204 Varchar(2),
    HL_205 Varchar(8),
    TD_124 Varchar(4),
    BM_160 Varchar(4),
    HF_178 Varchar(4),
    UT Varchar(12),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
--DECLARE VARIABLE Result2 Integer; 
BEGIN
    --Result2 = -1; 
    Result = NULL;   
    -- SELECT EVENTID FROM event_details WHERE EVENTID=:EVENTID and ut>:ut  into :Result;
    --SELECT EVENTID FROM event_details WHERE EVENTID=:EVENTID   into :Result;
    --IF (Result is NULL) then
    UPDATE OR INSERT INTO   event_details ( 
EVENTID,
  WC_8 ,
  PC_36 ,
  PL_16 ,
  EPL_50 ,
  NOP_17,
  EPTC_58,
  IT_151 ,
  ATT_141,
  FHSD_19 ,
  SHSD_20 ,
  FEHSD_44 ,
  SEHSD_45,
  PSSD_150 ,
  FHIT_201,
  SHIT_202 ,
  FEHIT_203 ,
  SEHIT_204,
  HL_205 ,
  TD_124 ,
  BM_160 ,
  HF_178 ,
  UT ,
  CTIMESTAMP)VALUES
      (  :EVENTID,
  :WC_8 ,
  :PC_36 ,
  :PL_16 ,
  :EPL_50 ,
  :NOP_17,
  :EPTC_58,
  :IT_151 ,
  :ATT_141,
  :FHSD_19 ,
  :SHSD_20 ,
  :FEHSD_44 ,
  :SEHSD_45,
  :PSSD_150 ,
  :FHIT_201,
  :SHIT_202 ,
 :FEHIT_203 ,
  :SEHIT_204,
  :HL_205 ,
  :TD_124 ,
  :BM_160 ,
  :HF_178 ,
  :UT ,
  :CTIMESTAMP      )  MATCHING  ( EVENTID)           RETURNING EVENTID INTO :Result; 
  --ELSE   
   --Result=Result2; 
       --    Result2   =:Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_INCIDENTS (
    ID Varchar(12),
    EVENTID Integer,
    CACTION Varchar(8),
    INCIDENT_ID Integer,
    INCIDENT_NAME Varchar(50),
    PARTICIPANT_ID Varchar(100),
    PARTICIPANT_NAME Varchar(100),
    SUBPARTICIPANT_ID Varchar(100),
    SUBPARTICIPANT_NAME Varchar(100),
    IMPORTANT_FOR_TRADER ,
    EVENT_TIME Varchar(6),
    EVENT_STATUS_ID Integer,
    EVENT_STATUS_NAME Varchar(50),
    UT Varchar(12),
    CTIMESTAMP Timestamp,
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL;  
    UPDATE OR INSERT INTO   INCIDENTS (  ID ,
  EVENTID ,
  CACTION ,
  INCIDENT_ID ,
  INCIDENT_NAME ,
  PARTICIPANT_ID ,
  PARTICIPANT_NAME ,
  SUBPARTICIPANT_ID ,
  SUBPARTICIPANT_NAME ,
  IMPORTANT_FOR_TRADER ,
  EVENT_TIME ,
  EVENT_STATUS_ID ,
  EVENT_STATUS_NAME ,UT,
  CTIMESTAMP,TEAMTYPE)VALUES
      ( :ID ,
  :EVENTID ,
  :CACTION ,
  :INCIDENT_ID ,
  :INCIDENT_NAME ,
  :PARTICIPANT_ID ,
  :PARTICIPANT_NAME ,
  :SUBPARTICIPANT_ID ,
  :SUBPARTICIPANT_NAME ,
  :IMPORTANT_FOR_TRADER ,
  :EVENT_TIME ,
  :EVENT_STATUS_ID ,
  :EVENT_STATUS_NAME ,:UT,
  :CTIMESTAMP,:TEAMTYPE) MATCHING  (ID );
        --RETURNING ID INTO :Result; 
      
SELECT  first 1 EMATCHID FROM EMATCHES WHERE EMATCHID=:EVENTID into :Result;

   IF (Result is NULL) then  
    begin
    Result=0;
    end
    else 
    begin
    Result=1; 
    end    
        
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_JSON_EVENT (
    ID Integer,
    NAME Varchar(100),
    HOME_ID Integer,
    GUEST_ID Integer,
    RELATION_STATUS Varchar(15),
    START_DATE Timestamp,
    FT_ONLY ,
    COVERAGE_TYPE Varchar(10),
    SCOUTSFEED ,
    STATUS_ID Integer,
    STATUS_TYPE Varchar(15),
    CDAY Varchar(10),
    CLOCK_TIME Varchar(18),
    CLOCK_STATUS Varchar(10),
    BET_STATUS Varchar(10),
    NEUTRAL_VENUE ,
    ITEM_STATUS Varchar(10),
    UT Varchar(12),
    ROUND_ID Varchar(10),
    ROUND_NAME Varchar(50),
    VENUE_ID Varchar(10),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp,
    CACTION Varchar(6) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE STATUSName varchar(30); 
BEGIN 
     Result = NULL;   
     SELECT ID FROM events WHERE ID=:ID and ut>:UT  into :Result; 
     IF (Result is NULL) then
    begin
    
    STATUSName = NULL;   
    select name from STATUSES where id =:STATUS_ID     INTO :STATUSName;
    
    UPDATE OR INSERT INTO   events ( ID ,
  NAME  ,
  HOME_ID ,
  GUEST_ID  ,
  --SOURCE ,
  --SOURCE_DC ,
 -- SOURCE_SUPER  ,
  RELATION_STATUS,
  START_DATE ,
  FT_ONLY,
  COVERAGE_TYPE ,
 -- CHANNEL_ID ,
 -- CHANNEL_NAME ,
  SCOUTSFEED ,
  STATUS_ID,
 STATUS_NAME,
  STATUS_TYPE ,
  CDAY ,
  CLOCK_TIME ,
  CLOCK_STATUS ,
 -- WINNER_ID ,
--  PROGRESS_ID ,
  BET_STATUS ,
  NEUTRAL_VENUE,
  ITEM_STATUS ,
  UT ,
  --OLD_EVENT_ID ,
 -- SLUG,
  --VERIFIED_RESULT,
  --IS_PROTOCOL_VERIFIED,
 -- PROTOCOL_VERIFIED_BY ,
  --PROTOCOL_VERIFIED_AT, 
  ROUND_ID ,
  ROUND_NAME ,
 -- CLIENT_EVENT_ID ,
  --BOOKED ,
  --BOOKED_BY ,
  --INVERTED_PARTICIPANTS,
  VENUE_ID,
 -- GROUP_ID ,
  STAGE_ID ,
  SEASON_ID ,
  COMPETITION_ID ,
  AREA_ID ,
  CTIMESTAMP ,
  CACTION  )VALUES
      (  :ID ,
   :NAME  ,
   :HOME_ID ,
   :GUEST_ID  ,
  -- :SOURCE ,
 -- :SOURCE_DC ,
  --:SOURCE_SUPER  ,
  :RELATION_STATUS,
  :START_DATE ,
  :FT_ONLY,
  :COVERAGE_TYPE ,
--  :CHANNEL_ID ,
 -- :CHANNEL_NAME ,
  :SCOUTSFEED ,
  :STATUS_ID,
  :STATUSName,
  :STATUS_TYPE ,
  :CDAY ,
  :CLOCK_TIME ,
  :CLOCK_STATUS ,
 -- :WINNER_ID ,
 -- :PROGRESS_ID ,
  :BET_STATUS ,
  :NEUTRAL_VENUE,
  :ITEM_STATUS ,
   :UT ,
 --:OLD_EVENT_ID ,
 -- :SLUG,
  --:VERIFIED_RESULT,
  --:IS_PROTOCOL_VERIFIED,
 -- :PROTOCOL_VERIFIED_BY ,
 -- :PROTOCOL_VERIFIED_AT,
  :ROUND_ID ,
  :ROUND_NAME ,
  --:CLIENT_EVENT_ID ,
  --:BOOKED ,
  --:BOOKED_BY ,
  --:INVERTED_PARTICIPANTS,
  :VENUE_ID,
 -- :GROUP_ID ,
  :STAGE_ID ,
  :SEASON_ID ,
  :COMPETITION_ID ,
  :AREA_ID ,
  :CTIMESTAMP ,
  :CACTION      )  MATCHING  ( ID)  RETURNING ID INTO :Result; 
  
  -- SELECT  first 1 ID FROM events WHERE ID=:ID order by start_date desc into :Result; 
    IF (Result is NULL) then  
   Begin
    Result=-1;
    End
  --  else 
  --  begin
  --  Result=1; 
  --  end  
 end
else
 begin
 Result=0; 
 end
       
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_JSON_EVENT_BAK (
    ID Integer,
    NAME Varchar(100),
    HOME_ID Integer,
    GUEST_ID Integer,
    RELATION_STATUS Varchar(15),
    START_DATE Timestamp,
    FT_ONLY ,
    COVERAGE_TYPE Varchar(10),
    SCOUTSFEED ,
    STATUS_ID Integer,
    STATUS_TYPE Varchar(15),
    CDAY Varchar(10),
    CLOCK_TIME Varchar(18),
    CLOCK_STATUS Varchar(10),
    BET_STATUS Varchar(10),
    NEUTRAL_VENUE ,
    ITEM_STATUS Varchar(10),
    ROUND_ID Varchar(10),
    ROUND_NAME Varchar(50),
    VENUE_ID Varchar(10),
    STAGE_ID Integer,
    SEASON_ID Integer,
    COMPETITION_ID Integer,
    AREA_ID Integer,
    CTIMESTAMP Timestamp,
    CACTION Varchar(6) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE STATUSName varchar(30); 
BEGIN 
  --  Result2 = -1; 
    STATUSName = NULL;   
    select name from STATUSES where id =:STATUS_ID     INTO :STATUSName;
    
 UPDATE OR INSERT INTO   events ( ID ,
  NAME  ,
  HOME_ID ,
  GUEST_ID  ,
  --SOURCE ,
  --SOURCE_DC ,
 -- SOURCE_SUPER  ,
  RELATION_STATUS,
  START_DATE ,
  FT_ONLY,
  COVERAGE_TYPE ,
 -- CHANNEL_ID ,
 -- CHANNEL_NAME ,
  SCOUTSFEED ,
  STATUS_ID,
 STATUS_NAME,
  STATUS_TYPE ,
  CDAY ,
  CLOCK_TIME ,
  CLOCK_STATUS ,
 -- WINNER_ID ,
--  PROGRESS_ID ,
  BET_STATUS ,
  NEUTRAL_VENUE,
  ITEM_STATUS ,
  --UT ,
  --OLD_EVENT_ID ,
 -- SLUG,
  --VERIFIED_RESULT,
  --IS_PROTOCOL_VERIFIED,
 -- PROTOCOL_VERIFIED_BY ,
  --PROTOCOL_VERIFIED_AT,
  ROUND_ID ,
  ROUND_NAME ,
 -- CLIENT_EVENT_ID ,
  --BOOKED ,
  --BOOKED_BY ,
  --INVERTED_PARTICIPANTS,
  VENUE_ID,
 -- GROUP_ID ,
  STAGE_ID ,
  SEASON_ID ,
  COMPETITION_ID ,
  AREA_ID ,
  CTIMESTAMP ,
  CACTION  )VALUES
      (  :ID ,
   :NAME  ,
   :HOME_ID ,
   :GUEST_ID  ,
  -- :SOURCE ,
 -- :SOURCE_DC ,
  --:SOURCE_SUPER  ,
  :RELATION_STATUS,
  :START_DATE ,
  :FT_ONLY,
  :COVERAGE_TYPE ,
--  :CHANNEL_ID ,
 -- :CHANNEL_NAME ,
  :SCOUTSFEED ,
  :STATUS_ID,
  :STATUSName,
  :STATUS_TYPE ,
  :CDAY ,
  :CLOCK_TIME ,
  :CLOCK_STATUS ,
 -- :WINNER_ID ,
 -- :PROGRESS_ID ,
  :BET_STATUS ,
  :NEUTRAL_VENUE,
  :ITEM_STATUS ,
  --:UT ,
 --:OLD_EVENT_ID ,
 -- :SLUG,
  --:VERIFIED_RESULT,
  --:IS_PROTOCOL_VERIFIED,
 -- :PROTOCOL_VERIFIED_BY ,
 -- :PROTOCOL_VERIFIED_AT,
  :ROUND_ID ,
  :ROUND_NAME ,
  --:CLIENT_EVENT_ID ,
  --:BOOKED ,
  --:BOOKED_BY ,
  --:INVERTED_PARTICIPANTS,
  :VENUE_ID,
 -- :GROUP_ID ,
  :STAGE_ID ,
  :SEASON_ID ,
  :COMPETITION_ID ,
  :AREA_ID ,
  :CTIMESTAMP ,
  :CACTION      )  MATCHING  ( ID) ;
  
SELECT  first 1 ID FROM events WHERE ID=:ID order by start_date desc into :Result;

   IF (Result is NULL) then  
    begin
    Result=0;
    end
    else 
    begin
    Result=1; 
    end 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_PARTICIPANT_RESULTS (
    EVENTID Integer,
    PARTICIPANTID Integer,
    PROGRESS_412 Varchar(1),
    WINNER_411 Varchar(1),
    RESULT_2 Varchar(3),
    RT_3 Varchar(3),
    FH_4 Varchar(3),
    SH_5 Varchar(3),
    E1H_133 Varchar(2),
    E2H_134 Varchar(2),
    PENALTY_7 Varchar(2),
    OVERTIME_104 Varchar(2),
    CTIMESTAMP Timestamp,
    CACTION Varchar(6),
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL;  
    UPDATE OR INSERT INTO   participant_results (
EVENTID,
  participantID ,
 progress_412 ,
  winner_411 ,
  result_2 ,
  rt_3 ,
  fh_4 ,
 sh_5 ,
  e1h_133 ,
  e2h_134  ,
  penalty_7 ,
  overtime_104 ,
  CTIMESTAMP,CACTION,TEAMTYPE)VALUES
      ( :EVENTID,
  :participantID ,
 :progress_412 ,
 :winner_411 ,
  :result_2 ,
  :rt_3 ,
  :fh_4 ,
 :sh_5 ,
  :e1h_133 ,
  :e2h_134  ,
  :penalty_7 ,
  :overtime_104 ,
  :CTIMESTAMP,:CACTION,:TEAMTYPE) MATCHING  (EVENTID,participantID )
        RETURNING participantID INTO :Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_PARTICIPANT_STATS (
    EVENTID Integer,
    PARTICIPANTID Integer,
    SOT_20 Varchar(3),
    SOT_21 Varchar(3),
    ATTACKS_10 Varchar(3),
    DA_11 Varchar(3),
    CORNERS_13 Varchar(3),
    YELLOW_CARDS_8 Varchar(3),
    RED_CARDS_9 Varchar(3),
    TOTAL_SHOTS_19 Varchar(3),
    FOULS_22 Varchar(3),
    OFFSIDES_24 Varchar(3),
    PS_14 Varchar(3),
    PM_15 Varchar(3),
    PG_16 Varchar(3),
    FK_25 Varchar(10),
    DFK_26 Varchar(3),
    FKG_18 Varchar(3),
    SW_27 Varchar(3),
    SB_28 Varchar(3),
    GS_29 Varchar(3),
    GK_30 Varchar(3),
    TI_32 Varchar(3),
    SUBSTITUTIONS_31 Varchar(3),
    GOALS_40 Varchar(3),
    MP_34 Varchar(3),
    OWN_GOALS_17 Varchar(3),
    ADW_33 Varchar(3),
    FORM_716 Varchar(100),
    SKIN_718 Varchar(8),
    PS_639 Varchar(3),
    PU_697 Varchar(3),
    GOALS115_772 Varchar(3),
    GOALS1630_773 Varchar(3),
    GOALS3145_774 Varchar(3),
    GOALS4660_775 Varchar(3),
    GOALS6175_776 Varchar(3),
    GOALS7690_777 Varchar(3),
    MPG_778 Varchar(3),
    MPS_779 Varchar(3),
    CTIMESTAMP Timestamp,
    CACTION Varchar(6),
    TEAMTYPE Varchar(1) )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result = NULL;  
    UPDATE OR INSERT INTO   PARTICIPANT_STATS (
  EVENTID ,
  PARTICIPANTID ,
  SOT_20 ,
  SOT_21 ,
  ATTACKS_10 ,
  DA_11 ,
  CORNERS_13 ,
  YELLOW_CARDS_8,
  RED_CARDS_9 ,
  TOTAL_SHOTS_19 ,
  FOULS_22 ,
  OFFSIDES_24,
  PS_14 ,
  PM_15 ,
  PG_16 ,
  FK_25 ,
  DFK_26 ,
  FKG_18,
  SW_27 ,
  SB_28 ,
  GS_29 ,
  GK_30,
  TI_32 ,
  SUBSTITUTIONS_31,
  GOALS_40,
  MP_34 ,
  OWN_GOALS_17 ,
  ADW_33 ,
  FORM_716 ,
  SKIN_718 ,
  PS_639 ,
  PU_697 ,
  GOALS115_772 ,
  GOALS1630_773 ,
  GOALS3145_774 ,
  GOALS4660_775,
  GOALS6175_776 ,
  GOALS7690_777,
  MPG_778,
  MPS_779 ,
  CTIMESTAMP,CACTION  ,TEAMTYPE  )VALUES
      ( :EVENTID ,
 :PARTICIPANTID ,
  :SOT_20 ,
  :SOT_21 ,
  :ATTACKS_10 ,
  :DA_11 ,
  :CORNERS_13 ,
  :YELLOW_CARDS_8,
  :RED_CARDS_9 ,
  :TOTAL_SHOTS_19 ,
  :FOULS_22 ,
  :OFFSIDES_24,
  :PS_14 ,
  :PM_15 ,
  :PG_16 ,
  :FK_25 ,
  :DFK_26 ,
  :FKG_18,
  :SW_27 ,
  :SB_28 ,
  :GS_29 ,
  :GK_30,
  :TI_32 ,
  :SUBSTITUTIONS_31,
  :GOALS_40,
  :MP_34 ,
  :OWN_GOALS_17 ,
  :ADW_33 ,
  :FORM_716 ,
  :SKIN_718 ,
  :PS_639 ,
  :PU_697 ,
  :GOALS115_772 ,
  :GOALS1630_773 ,
  :GOALS3145_774 ,
  :GOALS4660_775,
  :GOALS6175_776 ,
  :GOALS7690_777,
  :MPG_778,
  :MPS_779 ,
  :CTIMESTAMP,:CACTION  ,:TEAMTYPE  ) MATCHING  (EVENTID,participantID )
        RETURNING participantID INTO :Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_RESULT_GOALINFO (
    EMATCHID Integer,
    STATUS Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE iStatus integer; 
--DECLARE VARIABLE iH_GOAL integer; 
--DECLARE VARIABLE iG_GOAL integer; 
BEGIN
    Result= null;  
     
     --UPDATE  GOALINFO set  H_GOAL=:H_GOAL, G_GOAL=:G_GOAL ,LASTTIME=:LASTTIME  WHERE EMATCHID  = :EMATCHID ;
    ----  RETURNING EMATCHID INTO :Result;  
    -- select  first 1  e.STATUS_ID,g.H_GOAL,g.G_GOAL  from events e inner join GOALINFO g on g.EMATCHID=e.ID where e.id=:EMATCHID order by e.CTIMESTAMP desc   INTO :iStatus,:iH_GOAL,:iG_GOAL; 
    -- if((:STATUS=9  and :iStatus=33)  or (:STATUS=34 and :iStatus=9 ) or (:STATUS=34 and :iStatus=33 )) then 
   --  begin
    -- update GOALINFO g set g.HH_GOAL=:iH_GOAL ,g.GH_GOAL=:iG_GOAL where g.EMATCHID=:EMATCHID;
   --  end  
     
    UPDATE OR INSERT INTO  GOALINFO  (EMATCHID, H_GOAL ,G_GOAL,LASTTIME)VALUES (:EMATCHID,:H_GOAL,:G_GOAL,:LASTTIME) MATCHING  (EMATCHID) RETURNING EMATCHID INTO :Result; 
    
    
  
   -- SELECT  first 1 EMATCHID FROM EMATCHES WHERE EMATCHID=:EMATCHID into :Result;

   --IF (Result is NULL) then  
   -- begin
   -- Result=0;
   -- end
   -- else 
   -- begin
   -- Result=1; 
   -- end    
 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_STATS_GOALINFO (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
   -- UPDATE  GOALINFO set  H_RED=:H_RED, G_RED=:G_RED,H_YELLOW=:H_YELLOW,G_YELLOW=:G_YELLOW,LASTTIME=:LASTTIME  WHERE EMATCHID  = :EMATCHID   RETURNING EMATCHID INTO :Result; 
 UPDATE OR INSERT INTO  GOALINFO  (EMATCHID, H_RED ,G_RED,H_YELLOW,G_YELLOW,LASTTIME)VALUES (:EMATCHID,:H_RED,:G_RED,:H_YELLOW ,:G_YELLOW,:LASTTIME) MATCHING  (EMATCHID) RETURNING EMATCHID INTO :Result;  
       
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_STATS_RESULT_GOALINFO (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    STATUSID Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null; 
    SELECT  first 1 EMATCHID FROM GOALINFO  INNER JOIN EVENTS E ON E.ID=EMATCHID
    WHERE EMATCHID=:EMATCHID and  (H_RED=:H_RED or :H_RED is null )  and (G_RED=:G_RED or :G_RED is null ) and (H_YELLOW=:H_YELLOW or :H_YELLOW is null )
    and (G_YELLOW=:G_YELLOW or :G_YELLOW is null ) and (H_GOAL=:H_GOAL or :H_GOAL is null ) and  (G_GOAL=:G_GOAL or :G_GOAL is null ) AND (E.STATUS_ID=:STATUSID)
    into :Result;
   if(Result is null) then
   begin  
   UPDATE  GOALINFO set  H_RED=:H_RED, G_RED=:G_RED,H_YELLOW=:H_YELLOW,G_YELLOW=:G_YELLOW,H_GOAL=:H_GOAL, G_GOAL=:G_GOAL ,  LASTTIME=:LASTTIME  
   WHERE EMATCHID  = :EMATCHID;-- RETURNING EMATCHID INTO :Result; 
   
   SELECT  first 1 EMATCHID FROM EMATCHES WHERE EMATCHID=:EMATCHID into :Result;
   IF (Result is NULL) then  
    begin
    Result=0;
    end
    else 
    begin
    Result=1; 
    end    
    
   end 
   else
   begin 
   Result=-1;
   end  
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE PR_STATS_RESULT_GOALINFO_BAK (
    EMATCHID Integer,
    H_YELLOW Integer,
    H_RED Integer,
    G_YELLOW Integer,
    G_RED Integer,
    H_GOAL Integer,
    G_GOAL Integer,
    LASTTIME Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null; 
    SELECT  first 1 EMATCHID FROM GOALINFO 
    WHERE EMATCHID=:EMATCHID and  (H_RED=:H_RED or :H_RED is null )  and (G_RED=:G_RED or :G_RED is null ) and (H_YELLOW=:H_YELLOW or :H_YELLOW is null )
    and (G_YELLOW=:G_YELLOW or :G_YELLOW is null ) and (H_GOAL=:H_GOAL or :H_GOAL is null ) and  (G_GOAL=:G_GOAL or :G_GOAL is null )
    into :Result;
   if(Result is null) then
   begin  
   UPDATE  GOALINFO set  H_RED=:H_RED, G_RED=:G_RED,H_YELLOW=:H_YELLOW,G_YELLOW=:G_YELLOW,H_GOAL=:H_GOAL, G_GOAL=:G_GOAL ,  LASTTIME=:LASTTIME  
   WHERE EMATCHID  = :EMATCHID;-- RETURNING EMATCHID INTO :Result; 
   
   SELECT  first 1 EMATCHID FROM EMATCHES WHERE EMATCHID=:EMATCHID into :Result;
   IF (Result is NULL) then  
    begin
    Result=0;
    end
    else 
    begin
    Result=1; 
    end    
    
   end 
   else
   begin 
   Result=-1;
   end  
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SET_BOOKEDEVENT (
    ID Integer,
    BOOKED ,
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
  Result = NULL; 
  SELECT ID  FROM events WHERE id= :id into :Result;
  IF (Result is  not NULL) then 
UPDATE  events set  booked=true ,  ctimestamp =:ctimestamp  WHERE id= :id  RETURNING id INTO :Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SET_BOOKEDEVENTBY (
    ID Integer,
    BOOKED ,
    BOOKED_BY Varchar(50),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
  Result = NULL;  
UPDATE    events set  booked=:BOOKED ,BOOKED_BY=:BOOKED_BY,  ctimestamp =:ctimestamp WHERE id= :id ;--  RETURNING id INTO :Result; 
UPDATE    EMATCHES  e set e.MAPPINGSTATUS=:BOOKED    WHERE e.EMATCHID =:id ;
SELECT FIRST 1 ID  FROM events WHERE id= :id     into :Result;
  IF (Result is   NULL) then  
  Result=-1;
--SELECT ID  FROM EVENTS E where  E.ID=  (SELECT  first 1 p.ID  FROM events  P WHERE p.id= :id   ORDER BY p.START_DATE DESC)  into :Result;

END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNCHKJCDATAANDBOOK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
BEGIN
    Result = null;  
    Result2=-2;
    SELECT id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) into : Result2;
    IF (Result2 is not NULL) then 
  UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
BEGIN
    Result = null;  
    Result2=-2;
    SELECT id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) into : Result2;
    IF (Result2 = -2) then  
    UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
    else if (Result2 >0)
    then
     --UPDATE  events set  booked=true  WHERE id=:Result2;
     UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_AUTO (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
DECLARE VARIABLE TeamResult Integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);
  
DECLARE VARIABLE  TEAM_ID integer; 
DECLARE VARIABLE  TID integer; 
BEGIN
    Result = null;  
    Result2=null;
    --SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null)  order by start_date desc into : Result2;
   --SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) and (caction !='delete' or caction is null)  order by start_date desc into : Result2;
 SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null) AND  start_date >= :CMATCHDATETIME1 and start_date <= :CMATCHDATETIME2   order by start_date desc into : Result2;
     IF (Result2 is null) then 
    begin 
    Result2=0;
     UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    end
     else if (Result2 >0) then
     begin 
     UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and (EMATCHID is null or ematchid ='0')and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  
     RETURNING EMATCHID INTO :Result; 
     
     --start sync team
     Select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.ID TID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME  ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
      INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
     where (T.HKJC_ID IS NULL OR T.MAPPING_STATUS IS NOT TRUE ) AND  E.EMATCHID=:Result  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2 
      order by t.HKJC_ID asc 
     INTO :TeamResult ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( TeamResult IS NOT NULL AND TeamResult >0)  then
begin 
 IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 ) THEN
      BEGIN
      if(:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
      :TID=:TEAM_HOME_ID;
      END 
      else IF(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
       :TID=:TEAM_GUEST_ID;
      END 
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_HOME ,:HKJC_HOME_ID, :HKJC_HOME_CN ,
    --           'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN|| ','||current_timestamp||') MATCHING  (ID)'
     --   ||'----'||' UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN ||','||current_timestamp||') MATCHING  (ID) ') ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES ( :TID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END
      ELSE IF ( position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0) THEN 
      BEGIN 
        if(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
      :TID=:TEAM_GUEST_ID;
      END 
      else IF (:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
       :TID=:TEAM_HOME_ID;
      END  
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_GUEST ,:HKJC_GUEST_ID, :HKJC_GUEST_CN ,
    --      'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN|| ','||current_timestamp||') MATCHING  (ID)'
      --  ||'----'||'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_HOME_ID||','|| :HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN ||','||current_timestamp||') MATCHING  (ID)'  ) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END 
      else
      BEGIN 
         INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME||'/'||:TEAM_ShortName, :TeamResult,current_timestamp,'SyncTeam2' , :TEAM_ID ,:HKJC_HOME||'/'||:HKJC_GUEST) ;
    UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
       RESULT=0;
       
      END
      --IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      --BEGIN
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --RESULT=2;
      --END
      --else
      --BEGIN 
      --RESULT=0;
      --END
end 
else
 begin 
  RESULT=0;
 end
end 
     SELECT first 1 EMATCHID FROM EMATCHES WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2    order by CTIMESTAMP desc into : RESULT;
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_AUTO_BAK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
BEGIN
    Result = null;  
    Result2=0;
    SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null)  order by start_date desc into : Result2;
    IF (Result2 <= 0) then  
    UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    else if (Result2 >0)
    then
     --UPDATE  events set  booked=true  WHERE id=:Result2;
    UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and (EMATCHID is null or ematchid ='0')and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    SELECT first 1 EMATCHID FROM EMATCHES WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2    order by CTIMESTAMP desc into : RESULT;
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_AUTO_BAK2 (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
DECLARE VARIABLE TeamResult Integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);  

BEGIN
    Result = null;  
    Result2=null;
    --SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null)  order by start_date desc into : Result2;
   --SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) and (caction !='delete' or caction is null)  order by start_date desc into : Result2;
 SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null) AND  start_date >= :CMATCHDATETIME1 and start_date <= :CMATCHDATETIME2   order by start_date desc into : Result2;
     IF (Result2 is null) then 
    begin 
    Result2=0;
     UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    end
     else if (Result2 >0) then
     begin 
     UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and (EMATCHID is null or ematchid ='0')and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  
     RETURNING EMATCHID INTO :Result; 
     
     --start sync team
     Select E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME  ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
      INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
     where T.HKJC_ID IS NULL AND  E.EMATCHID=:Result  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2 
      order by t.HKJC_ID asc 
     INTO :TeamResult ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( TeamResult IS NOT NULL AND TeamResult >0)  then
begin
  --IF(:TEAM_HOME_NAME=:HKJC_HOME OR :TEAM_GUEST_ShortName=:HKJC_HOME) THEN 
  --IF( position(:HKJC_HOME  in :TEAM_HOME_NAME)>0 OR position(:HKJC_HOME in :TEAM_GUEST_ShortName)>0) THEN
      IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      BEGIN
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      RESULT=2;
      END
      else
      BEGIN 
      RESULT=0;
      END
end 
else
 begin 
  RESULT=0;
 end
     end 
     SELECT first 1 EMATCHID FROM EMATCHES WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2    order by CTIMESTAMP desc into : RESULT;
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME (
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp,
    ALIAS Varchar(6) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
DECLARE VARIABLE TeamResult Integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);
  
DECLARE VARIABLE  TEAM_ID integer; 
DECLARE VARIABLE  TID integer; 
BEGIN
    Result = null;  
    Result2=null;
    
           INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( '0',current_timestamp,:HKJCHOSTNAME||:HKJCGUESTNAME ,:Result2,  :HKJCDAYCODE||:HKJCMATCHNO ||'  SyncMatch2' , 
     'select x.id from ( select e.START_DATE,e.CACTION, e.id,e.NAME,e.HOME_ID,e.GUEST_ID,'||
'(select  t.HKJC_NAME from teams t where t.id =e.HOME_ID) HKJChome ,'||
'(select t.HKJC_NAME from teams t where t.id =e.GUEST_ID) HKJCguest,'||
'(select t.NAME||''/''||t.SHORT_NAME from teams t where t.id =e.HOME_ID) home ,'||
'(select t.NAME||''/''||t.SHORT_NAME from teams t where t.id =e.GUEST_ID) guest from  events e) x  '||
'where ' ||
 ' (x.CACTION !=''delete'' or x.caction is null) AND  (x.start_date >='''||:CMATCHDATETIME1||''' and x.start_date <='''|| :CMATCHDATETIME2||''')  and ('||
 ' (x.HKJChome ='''||:HKJCHOSTNAME||''' and x.HKJCguest='''||:HKJCGUESTNAME||''') '|| 
 ' or (x.HKJChome ='''||:HKJCGUESTNAME||''' and x.HKJCguest='''||:HKJCHOSTNAME||''' )'||
 ' or ( x.home like ''%''||'''||:HKJCHOSTNAME||'''||''%''  and x.guest like  ''%''||'''||:HKJCGUESTNAME||'''||''%'')'||
 ' or ( x.home like ''%''||'''||:HKJCGUESTNAME||'''||''%''  and x.guest like  ''%''||'''||:HKJCHOSTNAME||'''||''%''))'
  ) ;
  
    select x.id from ( select e.START_DATE,e.CACTION, e.id,e.NAME,e.HOME_ID,e.GUEST_ID,
(select  t.HKJC_NAME from teams t where t.id =e.HOME_ID) HKJChome ,
(select t.HKJC_NAME from teams t where t.id =e.GUEST_ID) HKJCguest,
(select t.NAME||'/'||t.SHORT_NAME from teams t where t.id =e.HOME_ID) home ,
(select t.NAME||'/'||t.SHORT_NAME from teams t where t.id =e.GUEST_ID) guest from  events e) x  
where     
     (x.CACTION !='delete' or x.caction is null) AND  (x.start_date >= :CMATCHDATETIME1 and x.start_date <= :CMATCHDATETIME2)  and (
      (x.HKJChome =:HKJCHOSTNAME and x.HKJCguest=:HKJCGUESTNAME)  
      or (x.HKJChome =:HKJCGUESTNAME and x.HKJCguest=:HKJCHOSTNAME )
      or ( x.home like '%'||:HKJCHOSTNAME||'%'  and x.guest like  '%'||:HKJCGUESTNAME||'%')
      or ( x.home like '%'||:HKJCGUESTNAME||'%'  and x.guest like  '%'||:HKJCHOSTNAME||'%')
      ) into : Result2;
    IF (Result2 is null) then 
    begin 
    Result2=0; 
     UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    end
     else if (Result2 >0) then
     begin     
     UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and (EMATCHID is null or ematchid ='0')and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  
     RETURNING EMATCHID INTO :Result; 
      --sync alias 20190228
      Update COMPETITIONS cc set cc.ALIAS=(select ce.CLEAGUEALIAS_OUTPUT_NAME from EMATCHES ce where ce.EMATCHID=:Result  ) where cc.id=(select ce2.COMPETITION_ID from events ce2 where ce2.id=:Result ) and cc.ALIAS is null;
      --start sync team
     Select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.ID TID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME  ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
      INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
     where (T.HKJC_ID IS NULL OR T.MAPPING_STATUS IS NOT TRUE ) AND  E.EMATCHID=:Result  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2 
      order by t.HKJC_ID asc 
     INTO :TeamResult ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( TeamResult IS NOT NULL AND TeamResult >0)  then
begin 
 IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 ) THEN
      BEGIN
      if(:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
      :TID=:TEAM_HOME_ID;
      END 
      else IF(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
       :TID=:TEAM_GUEST_ID;
      END 
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_HOME ,:HKJC_HOME_ID, :HKJC_HOME_CN ,
    --           'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN|| ','||current_timestamp||') MATCHING  (ID)'
     --   ||'----'||' UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN ||','||current_timestamp||') MATCHING  (ID) ') ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES ( :TID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END
      ELSE IF ( position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0) THEN 
      BEGIN 
        if(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
      :TID=:TEAM_GUEST_ID;
      END 
      else IF (:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
       :TID=:TEAM_HOME_ID;
      END  
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_GUEST ,:HKJC_GUEST_ID, :HKJC_GUEST_CN ,
    --      'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN|| ','||current_timestamp||') MATCHING  (ID)'
      --  ||'----'||'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_HOME_ID||','|| :HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN ||','||current_timestamp||') MATCHING  (ID)'  ) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END 
      else
      BEGIN 
      --   INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME||'/'||:TEAM_ShortName, :TeamResult,current_timestamp,'SyncTeam2' , :TEAM_ID ,:HKJC_HOME||'/'||:HKJC_GUEST) ;
    UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
       RESULT=0;
       
      END
      --IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      --BEGIN
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --RESULT=2;
      --END
      --else
      --BEGIN 
      --RESULT=0;
      --END
end 
else
 begin 
  RESULT=0;
 end
end 
     SELECT first 1 EMATCHID FROM EMATCHES WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2    order by CTIMESTAMP desc into : RESULT;
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME_BAK (
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100),
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
DECLARE VARIABLE TeamResult Integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);
  
DECLARE VARIABLE  TEAM_ID integer; 
DECLARE VARIABLE  TID integer; 
BEGIN
    Result = null;  
    Result2=null;
  --SELECT first 1 id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID) OR (home_id=:GUEST_ID  and GUEST_ID =:home_id) and (caction !='delete' or caction is null) AND  start_date >= :CMATCHDATETIME1 and start_date <= :CMATCHDATETIME2   order by start_date desc into : Result2;
    SELECT  first 1 e.id FROM EVENTS E
    inner join teams t on e.GUEST_ID=t.id or e.HOME_ID=t.id where( 
     --(T.HKJC_NAME=:HKJCHOSTNAME or t.NAME LIKE '%'||:HKJCHOSTNAME||'%'  OR T.SHORT_NAME LIKE '%'||:HKJCHOSTNAME||'%') OR
    -- (T.HKJC_NAME=:HKJCGUESTNAME or t.NAME LIKE '%'||:HKJCGUESTNAME||'%'   OR T.SHORT_NAME LIKE '%'||:HKJCGUESTNAME||'%'))
    (T.HKJC_NAME=:HKJCHOSTNAME or T.HKJC_NAME=:HKJCGUESTNAME )
   -- or
    --((t.NAME LIKE '%'||:HKJCHOSTNAME||'%'  OR T.SHORT_NAME LIKE '%'||:HKJCHOSTNAME||'%') OR  (t.NAME LIKE '%'||:HKJCGUESTNAME||'%' OR T.SHORT_NAME LIKE '%'||:HKJCGUESTNAME||'%'))
    --or 
    --((:HKJCGUESTNAME LIKE '%'||t.NAME||'%' OR :HKJCGUESTNAME LIKE '%'||t.SHORT_NAME||'%') OR  (:HKJCHOSTNAME LIKE '%'||t.NAME||'%'  OR :HKJCHOSTNAME LIKE '%'||t.SHORT_NAME||'%') )
     )
    and (e.CACTION !='delete' or e.caction is null) AND  e.start_date >= :CMATCHDATETIME1 and e.start_date <= :CMATCHDATETIME2   order by e.start_date desc into : Result2;
     IF (Result2 is null) then 
    begin 
    Result2=0; 
     UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  RETURNING EMATCHID INTO :Result; 
    end
     else if (Result2 >0) then
     begin 
     
       INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( '0',current_timestamp,:HKJCHOSTNAME||:HKJCGUESTNAME ,:Result2,  :HKJCDAYCODE||:HKJCMATCHNO ||'  SyncMatch' , 
     ' SELECT  first 1 e.id FROM EVENTS E inner join teams t on e.GUEST_ID=t.id or e.HOME_ID=t.id where('|| 
    '(T.HKJC_NAME='''||:HKJCHOSTNAME||''' or T.HKJC_NAME='''||:HKJCGUESTNAME||''' ) or'||
    '((t.NAME LIKE ''%''||'''||:HKJCHOSTNAME||'''||''%''  OR T.SHORT_NAME LIKE ''%''||'''||:HKJCHOSTNAME||'''||''%'') OR  (t.NAME LIKE ''%''||'''||:HKJCGUESTNAME||'''||''%'' OR T.SHORT_NAME LIKE ''%''||'''||:HKJCGUESTNAME||'''||''%''))'||
    'or (('''||:HKJCGUESTNAME||''' LIKE ''%''||t.NAME||''%'' OR '''||:HKJCGUESTNAME||''' LIKE ''%''||t.SHORT_NAME||''%'') OR  ('''||:HKJCHOSTNAME||''' LIKE ''%''||t.NAME||''%''  OR '''|| :HKJCHOSTNAME||''' LIKE ''%''||t.SHORT_NAME||''%'') )'||
     ') and (e.CACTION !=''delete'' or e.caction is null) AND  e.start_date >= '''||:CMATCHDATETIME1||''' and e.start_date <='''||:CMATCHDATETIME2 ||'''  order by e.start_date desc') ;
      
    
    
     
     UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and (EMATCHID is null or ematchid ='0')and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2  
     RETURNING EMATCHID INTO :Result; 
     
     --start sync team
     Select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.ID TID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME  ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
      INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
     where (T.HKJC_ID IS NULL OR T.MAPPING_STATUS IS NOT TRUE ) AND  E.EMATCHID=:Result  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2 
      order by t.HKJC_ID asc 
     INTO :TeamResult ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( TeamResult IS NOT NULL AND TeamResult >0)  then
begin 
 IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 ) THEN
      BEGIN
      if(:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
      :TID=:TEAM_HOME_ID;
      END 
      else IF(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
       :TID=:TEAM_GUEST_ID;
      END 
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_HOME ,:HKJC_HOME_ID, :HKJC_HOME_CN ,
    --           'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN|| ','||current_timestamp||') MATCHING  (ID)'
     --   ||'----'||' UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN ||','||current_timestamp||') MATCHING  (ID) ') ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES ( :TID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END
      ELSE IF ( position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0) THEN 
      BEGIN 
        if(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
      :TID=:TEAM_GUEST_ID;
      END 
      else IF (:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
       :TID=:TEAM_HOME_ID;
      END  
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_GUEST ,:HKJC_GUEST_ID, :HKJC_GUEST_CN ,
    --      'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN|| ','||current_timestamp||') MATCHING  (ID)'
      --  ||'----'||'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_HOME_ID||','|| :HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN ||','||current_timestamp||') MATCHING  (ID)'  ) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,true) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,true) MATCHING  (ID) ;
       RESULT=2;
      END 
      else
      BEGIN 
      --   INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME||'/'||:TEAM_ShortName, :TeamResult,current_timestamp,'SyncTeam2' , :TEAM_ID ,:HKJC_HOME||'/'||:HKJC_GUEST) ;
    UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
       RESULT=0;
       
      END
      --IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      --BEGIN
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN,TRUE,current_timestamp ) MATCHING  (ID) ;
      --RESULT=2;
      --END
      --else
      --BEGIN 
      --RESULT=0;
      --END
end 
else
 begin 
  RESULT=0;
 end
end 
     SELECT first 1 EMATCHID FROM EMATCHES WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2    order by CTIMESTAMP desc into : RESULT;
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCDATA_BOOK (
    HOME_ID Integer,
    GUEST_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE Result2 Integer; 
BEGIN
    Result = null;  
    Result2=-2;
    SELECT id FROM events WHERE (home_id=:home_id and GUEST_ID =:GUEST_ID)  or  (home_id=:GUEST_ID and GUEST_ID =:home_id ) into : Result2;
    IF (Result2 = -2) then  
    UPDATE  EMATCHES set  EMATCHID=:Result2 WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
    else if (Result2 >0)
    then
     UPDATE  events set  booked=true  WHERE id=:Result2;
    UPDATE  EMATCHES set  EMATCHID=:Result2   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
    
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_HKJCTEAM_WEB_SURE (
    EVENT_ID Integer )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
BEGIN
     RESULT= null;    
     select  id,HOME_ID,GUEST_ID  from EVENTS where  id=:EVENT_ID  INTO :RESULT,:TEAM_HOME_ID,:TEAM_GUEST_ID;
IF (RESULT >0) then
begin
       select  count(*)  from TEAMS where (ID= :TEAM_HOME_ID or id=:TEAM_GUEST_ID) and  HKJC_ID is not null into :RESULT;
       IF (RESULT =2) then
       begin 
      UPDATE TEAMS  set MAPPING_STATUS=true where (ID= :TEAM_HOME_ID or id=:TEAM_GUEST_ID) and  HKJC_ID is not null;
       RESULT=2;
       end
end 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCDATA (
    EVENT_ID Integer,
    HKJCHOSTNAME Varchar(100),
    HKJCGUESTNAME Varchar(100) )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
    UPDATE  EMATCHES set  EMATCHID=:Event_id    WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
    IF (RESULT is null)  then
begin
 UPDATE  EMATCHES set  EMATCHID=:Event_id   WHERE HKJCGUESTNAME  = :HKJCGUESTNAME    AND HKJCHOSTNAME =:HKJCHOSTNAME  RETURNING EMATCHID INTO :Result; 
   
 RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCDATA_WEB (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
    UPDATE EMATCHES SET  EMATCHID=NULL WHERE EMATCHID=:EVENT_ID;
    UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2   RETURNING EMATCHID INTO :Result; 
    IF (RESULT is null)  then
begin
    --UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO  and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2 RETURNING EMATCHID INTO :Result; 
    RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
    UPDATE EMATCHES SET  EMATCHID=NULL WHERE EMATCHID=:EVENT_ID;
    UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2   RETURNING EMATCHID INTO :Result; 
    IF (RESULT is null)  then
begin
    --UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO  and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2 RETURNING EMATCHID INTO :Result; 
    RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_CANCEL (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
    UPDATE  EMATCHES set  EMATCHID=NULL ,MAPPINGSTATUS=NULL  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO and EMATCHID =:EVENT_ID     RETURNING HKJCMATCHNO INTO :Result; 
    UPDATE  TEAMS  SET MAPPING_STATUS=NULL,hkjc_id=null ,hkjc_name=null,hkjc_name_cn=null -- update 2019318
    WHERE ID IN(SELECT a.ID FROM TEAMS A INNER JOIN EVENTS  E ON E.HOME_ID=A.ID OR E.GUEST_ID =A.ID WHERE E.ID=:EVENT_ID) ;
    IF (RESULT is null)  then
begin
   
 RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);  


BEGIN
     Result= null;    
     select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
     INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
      where  T.HKJC_ID IS NULL AND  E.EMATCHID=:Event_id  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2
      order by t.HKJC_ID asc 
      INTO :Result ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( RESULT IS NOT NULL AND RESULT >0)  then
begin
--log
--INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME, :EVENT_ID,current_timestamp,:TEAM_ShortName , 0 ,'TeamInfo') ;
     --position ('be' in 'To be or not to be')
     IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      BEGIN
     -- UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
     -- UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
      
      RESULT=2;
      END
      else
      BEGIN 
      RESULT=0;
      END
end
else
 begin 
  RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 

DECLARE VARIABLE  TEAM_HOME_NAME varchar(100);  
DECLARE VARIABLE  TEAM_GUEST_ShortName varchar(50);  


BEGIN
     Result= null;    
     select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
     INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
      where  T.HKJC_ID IS NULL AND  E.EMATCHID=:Event_id  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2
      order by t.HKJC_ID asc 
      INTO :Result ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_HOME_NAME,:TEAM_GUEST_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( RESULT IS NOT NULL AND RESULT >0)  then
begin
     IF(:TEAM_HOME_NAME=:HKJC_HOME OR :TEAM_GUEST_ShortName=:HKJC_HOME) THEN
     BEGIN
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
      RESULT=2;
      END
      else
      BEGIN 
      RESULT=0;
      END
end
else
 begin 
  RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE UPDATE_CNNAME_GOALINFO_PLAYERS (
    EMATCHID Varchar(20),
    TEAMID Integer,
    PARTICIPANTID Varchar(12),
    ENNAME Varchar(60),
    CNNAME Varchar(60),
    CTIMESTAMP Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  playerName Varchar(60);
BEGIN
  Result = NULL;  
UPDATE  MATCHDETAILS e  set  e.PLAYERCHI=:CNName,e.LASTTIME=:CTIMESTAMP   WHERE e.EMATCHID= :EMATCHID and e.PARTICIPANTID=:PARTICIPANTID ;--   RETURNING PLAYERCHI INTO :playerName; 
--UPDATE  PLAYERS p  set p.NAME_CN =:CNName ,p.CTIMESTAMP=:CTIMESTAMP  WHERE p.ID =:PARTICIPANTID ;
 UPDATE OR INSERT INTO  players ( ID,NAME,NAME_CN, TEAM_ID,event_id,CTIMESTAMP  ) VALUES  (:PARTICIPANTID,:ENName,:CNName,:TEAMID,:EMATCHID,:CTIMESTAMP ) MATCHING  (ID,TEAM_ID) ; 

 SELECT first 1 e.PLAYERCHI FROM MATCHDETAILS e WHERE  e.EMATCHID= :EMATCHID and e.PARTICIPANTID=:PARTICIPANTID into : playername;  
 
IF (playerName is NULL) then  
  Result=0; 
  else
   Result=1; 
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE WEB_SYNC_MANUAL_HKJCDATA (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
BEGIN
    Result= null;   
   -- UPDATE EMATCHES SET  EMATCHID=NULL WHERE EMATCHID=:EVENT_ID;
    --UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2   RETURNING EMATCHID INTO :Result; 
     UPDATE  EMATCHES E set  E.EMATCHID=:Event_id,E.MAPPINGSTATUS=NULL  WHERE E.HKJCDAYCODE  = :HKJCDAYCODE    AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2   RETURNING EMATCHID INTO :Result; 
     IF (RESULT is null)  then
begin
    --UPDATE  EMATCHES set  EMATCHID=:Event_id  WHERE HKJCDAYCODE  = :HKJCDAYCODE    AND HKJCMATCHNO =:HKJCMATCHNO  and CMATCHDATETIME >= :CMATCHDATETIME1 and CMATCHDATETIME <= :CMATCHDATETIME2 RETURNING EMATCHID INTO :Result; 
    RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  

DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);  
DECLARE VARIABLE  TEAM_ID integer; 
DECLARE VARIABLE  TID integer; 

BEGIN
     Result= null;    
     select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.ID TID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
     INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
      where  (T.HKJC_ID IS NULL OR T.MAPPING_STATUS IS NOT TRUE ) AND  E.EMATCHID=:Event_id  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2
      order by t.HKJC_ID asc 
      INTO :Result ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( RESULT IS NOT NULL AND RESULT >0)  then
begin
--log
--INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME, :EVENT_ID,current_timestamp,:TEAM_ShortName , 0 ,'TeamInfo') ;
     --position ('be' in 'To be or not to be')
     IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 ) THEN
      BEGIN
      if(:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
      :TID=:TEAM_HOME_ID;
      END 
      else IF(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
       :TID=:TEAM_GUEST_ID;
      END 
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_HOME ,:HKJC_HOME_ID, :HKJC_HOME_CN ,
    --           'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN|| ','||current_timestamp||') MATCHING  (ID)'
     --   ||'----'||' UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN ||','||current_timestamp||') MATCHING  (ID) ') ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,false) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES ( :TID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,false) MATCHING  (ID) ;
       RESULT=2;
      END
      ELSE IF ( position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0) THEN 
      BEGIN 
        if(:TEAM_ID=:TEAM_HOME_ID) then
      BEGIN 
      :TID=:TEAM_GUEST_ID;
      END 
      else IF (:TEAM_ID=:TEAM_GUEST_ID) then
      BEGIN 
       :TID=:TEAM_HOME_ID;
      END  
     --  INSERT INTO GOALINFO_LOG ( EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE,AID )VALUES  ( :EVENT_ID,current_timestamp,:HKJC_GUEST ,:HKJC_GUEST_ID, :HKJC_GUEST_CN ,
    --      'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_ID||','||:HKJC_GUEST_ID||','||:HKJC_GUEST||','||:HKJC_GUEST_CN|| ','||current_timestamp||') MATCHING  (ID)'
      --  ||'----'||'UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES ('||:TEAM_HOME_ID||','|| :HKJC_HOME_ID||','||:HKJC_HOME||','||:HKJC_HOME_CN ||','||current_timestamp||') MATCHING  (ID)'  ) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TEAM_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp,false) MATCHING  (ID) ;
       UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP,MAPPING_STATUS)VALUES (:TID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp,false) MATCHING  (ID) ;
       RESULT=2;
      END 
      else
      BEGIN 
       INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME||'/'||:TEAM_ShortName, :Result,current_timestamp,'SyncTeam' , :TEAM_ID ,:HKJC_HOME||'/'||:HKJC_GUEST) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
       RESULT=0;
       END
end
else
 begin 
  RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_BAK (
    EVENT_ID Integer,
    HKJCDAYCODE Varchar(3),
    HKJCMATCHNO Integer,
    CMATCHDATETIME1 Timestamp,
    CMATCHDATETIME2 Timestamp )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  HKJC_HOME_CN varchar(100); 
DECLARE VARIABLE  HKJC_GUEST_CN varchar(100); 
DECLARE VARIABLE  HKJC_HOME varchar(100); 
DECLARE VARIABLE  HKJC_GUEST varchar(100);  
DECLARE VARIABLE   HKJC_HOME_ID integer; 
DECLARE VARIABLE   HKJC_GUEST_ID integer;  
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 

DECLARE VARIABLE  TEAM_NAME varchar(100);  
DECLARE VARIABLE  TEAM_ShortName varchar(50);  


BEGIN
     Result= null;    
     select first 1 E.EMATCHID ,R.HOME_ID,R.GUEST_ID,T.NAME TNAME,T.SHORT_NAME TSHORTNAME ,E.HKJCHOSTID,E.HKJCGUESTID,E.HKJCHOSTNAME,E.HKJCGUESTNAME,E.HKJCHOSTNAME_CN,E.HKJCGUESTNAME_CN from EMATCHES E
     INNER JOIN EVENTS R ON R.ID=E.EMATCHID
     INNER JOIN TEAMS T ON T.ID=R.HOME_ID OR T.ID=R.GUEST_ID
      where  T.HKJC_ID IS NULL AND  E.EMATCHID=:Event_id  and E.HKJCDAYCODE  = :HKJCDAYCODE  AND E.HKJCMATCHNO =:HKJCMATCHNO and E.CMATCHDATETIME >= :CMATCHDATETIME1 and E.CMATCHDATETIME <= :CMATCHDATETIME2
      order by t.HKJC_ID asc 
      INTO :Result ,:TEAM_HOME_ID,:TEAM_GUEST_ID,:TEAM_NAME,:TEAM_ShortName,:HKJC_HOME_ID,:HKJC_GUEST_ID,:HKJC_HOME,:HKJC_GUEST,:HKJC_HOME_CN,:HKJC_GUEST_CN; 
IF ( RESULT IS NOT NULL AND RESULT >0)  then
begin
--log
--INSERT INTO GOALINFO_LOG   (AID,EMATCHID,LASTTIME,GAMESTATUS,ELAPSED,LOG_TYPE )VALUES  (:TEAM_NAME, :EVENT_ID,current_timestamp,:TEAM_ShortName , 0 ,'TeamInfo') ;
     --position ('be' in 'To be or not to be')
     IF( position(:HKJC_HOME  in :TEAM_NAME)>0 OR position(:HKJC_HOME in :TEAM_ShortName)>0 or position(:HKJC_GUEST  in :TEAM_NAME)>0 OR position(:HKJC_GUEST in :TEAM_ShortName)>0 ) THEN
      BEGIN
     -- UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
     -- UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,MAPPING_STATUS,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,FALSE,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_HOME_ID, :HKJC_HOME_ID,:HKJC_HOME,:HKJC_HOME_CN ,current_timestamp) MATCHING  (ID) ;
      UPDATE OR INSERT INTO  TEAMS  (ID, HKJC_ID ,HKJC_NAME,HKJC_NAME_CN,CTIMESTAMP)VALUES (:TEAM_GUEST_ID,:HKJC_GUEST_ID,:HKJC_GUEST,:HKJC_GUEST_CN ,current_timestamp) MATCHING  (ID) ;
      
      RESULT=2;
      END
      else
      BEGIN 
      RESULT=0;
      END
end
else
 begin 
  RESULT=0;
 end
END^
SET TERM ; ^


SET TERM ^ ;
ALTER PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_SURE (
    EVENT_ID Integer )
RETURNS (
    RESULT Integer )
AS
DECLARE VARIABLE  TEAM_HOME_ID integer; 
DECLARE VARIABLE  TEAM_GUEST_ID integer; 
BEGIN
     RESULT= null;    
     select  id,HOME_ID,GUEST_ID  from EVENTS where  id=:EVENT_ID  INTO :RESULT,:TEAM_HOME_ID,:TEAM_GUEST_ID;
IF (RESULT >0) then
begin
       select  count(*)  from TEAMS where (ID= :TEAM_HOME_ID or id=:TEAM_GUEST_ID) and  HKJC_ID is not null into :RESULT;
       IF (RESULT =2) then
       begin 
      UPDATE TEAMS  set MAPPING_STATUS=true where (ID= :TEAM_HOME_ID or id=:TEAM_GUEST_ID) and  HKJC_ID is not null;
       RESULT=2;
       end
end 
END^
SET TERM ; ^


CREATE INDEX IDX_EMATCHES1 ON EMATCHES (EMATCHID);
CREATE INDEX IDX_INCIDENTS ON INCIDENTS (EVENTID);
CREATE INDEX IDX_MATCHDETAILS1 ON MATCHDETAILS (EMATCHID);
CREATE INDEX IDX_TEAMS1 ON TEAMS (ID);
GRANT EXECUTE
 ON PROCEDURE ADD_ANALYSIS_HISTORY_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_ANALYSIS_RECENT_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_ANALYSIS_STAT_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_AREA7 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_COMPETITION TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_GROUP TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_HKJCMATCH TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_HKJCMATCH2 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_HKJCMATCH4 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_HKJCMATCH_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_PLAYER TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_PLAYER2 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_RANK_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_SCORERS_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_SEASON TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_STAGE TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_STANDINGS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_TEAM TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE ADD_TEAM2 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE DELETEEVENT_BYID TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE DELETE_INCIDENTS_BYEVENTID TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_EVENT_DETAILS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_EVENT_DETAILS_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_INCIDENTS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_JSON_EVENT TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_JSON_EVENT_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_PARTICIPANT_RESULTS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_PARTICIPANT_STATS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_RESULT_GOALINFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_STATS_GOALINFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_STATS_RESULT_GOALINFO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE PR_STATS_RESULT_GOALINFO_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SET_BOOKEDEVENT TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SET_BOOKEDEVENTBY TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNCHKJCDATAANDBOOK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_AUTO TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_AUTO_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_AUTO_BAK2 TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_AUTO_BYNAME_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCDATA_BOOK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_HKJCTEAM_WEB_SURE TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCDATA TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCDATA_WEB TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCDATA_WEB_CANCEL TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE SYNC_MANUAL_HKJCTEAM_WEB_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE UPDATE_CNNAME_GOALINFO_PLAYERS TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE WEB_SYNC_MANUAL_HKJCDATA TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_BAK TO  SYSDBA WITH GRANT OPTION;

GRANT EXECUTE
 ON PROCEDURE WEB_SYNC_MANUAL_HKJCTEAM_SURE TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_BG_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_HISTORY_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_OTHERS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_RECENT_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_REMARK_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON ANALYSIS_STAT_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON AREAS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON AREAS2 TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON COMPETITIONS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON EMATCHES TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON EVENTS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON EVENT_DETAILS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON GOALINFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON GOALINFO_LOG TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON GROUPS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON INCIDENTS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON INT_COUNTRY TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON INT_LEAGUE TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON INT_PLAYER TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON INT_TEAM TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON LEAGRANKINFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON LEAGUE_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON MATCHDETAILS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON PARTICIPANT_RESULTS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON PARTICIPANT_STATS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON PLAYERS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON PLAYERS_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON SCORERS_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON SEASONS TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON STAGES TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON STANDINGS_INFO TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON STATUSES TO  SYSDBA WITH GRANT OPTION;

GRANT DELETE, INSERT, REFERENCES, SELECT, UPDATE
 ON TEAMS TO  SYSDBA WITH GRANT OPTION;

